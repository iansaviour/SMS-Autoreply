var microsoft=microsoft||{},app,awasaServicesSettings;microsoft.support=microsoft.support||{};microsoft.support.config=microsoft.support.config||{};microsoft.support.config.authInfo=microsoft.support.config.authInfo||{},function(n){n.authState=2;n.isLoggedIn=function(){return n.puid!=null};n.authStatus=function(){return n.authState};n.userSignedIn=function(t){n.puidAsHex=t.puidAsHex;n.displayName=t.displayName;n.puid=t.puid;n.firstName=t.firstName;n.lastName=t.lastName;n.cid=t.cid;n.authState=1;i();r()};n.userSignedOut=function(){n.puidAsHex=null;n.displayName=null;n.puid=null;n.firstName=null;n.lastName=null;n.cid=null;n.authState=0;i();u()};var r=function(){t().$broadcast("UserSignedIn")},u=function(){t().$broadcast("UserSignedOut")},i=function(){t().$broadcast("AuthStatusChange")},t=function(){var n=angular.element(document.body);return n.scope().$root};return n}(microsoft.support.config.authInfo);try{document.domain="microsoft.com"}catch(e){}microsoft=microsoft||{};microsoft.support=microsoft.support||{};microsoft.support.moduleName="SelfAssistWeb";microsoft.support.config=microsoft.support.config||{};microsoft.support.serverInfo=microsoft.support.serverInfo||{};typeof console=="undefined"&&(console={});typeof console.log=="undefined"&&(console.log=function(){});app=angular.module(microsoft.support.moduleName,["ngSanitize","ngRoute","ngCookies","ngAria"]);app.value("clientConfig",microsoft.support.config);app.value("serverInfo",microsoft.support.serverInfo);app.run(["$rootScope","$timeout","$anchorScroll","$location",function(n,t,i,r){t(function(){n.$broadcast("AngularJsReady")},10);r&&r.hash&&r.hash()&&t(function(){i()},2e3)}]),function(n){n.factory("errorInterceptor",["$rootScope","$q",function(n,t){var i={},r=[/api\/search/i,/api\/content\/kb/i,/api\/content\/gwt/i,/api\/content\/getcompasscontentforpage/i];return i.responseError=function(i){var u=r.filter(function(n){return i.config&&i.config.url.match(n)!==null}).length>0;return u&&i.status===404?n.$broadcast("404Error"):u&&n.$broadcast("500Error",{reason:"Http request failed",response:i}),t.reject(i)},i}])}(angular.module(microsoft.support.moduleName));app.config(["$provide",function(n){n.decorator("$exceptionHandler",["$delegate","$injector",function(n,t){return function(i,r){var u={},f=t.get("qosTelemetryService");u.message=i.message||"";u.stack=i.stack||"";u.context=i&&JSON.stringify(i)||"";f.createEvent(f.eventTypes.app.exception).reject(JSON.stringify(u));n(i,r)}}])}]),function(){var e=[],n=this,r,u,l,a;this.Asimov=this.Asimov||{};this.Asimov.uploadUrl="https://vortex.data.microsoft.com/collect/v1";this.Asimov.correlationVectorTag="cV";this.Asimov.correlationVectorHeader="MS-CV";var o=63,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=null;"withCredentials"in new window.XMLHttpRequest?i="jQuery":window.XDomainRequest&&(i="XDomainRequest");r="Unknown";u=n.navigator&&n.navigator.appVersion?n.navigator.appVersion:"";u.indexOf("Win")!=-1?r="Windows":u.indexOf("Mac")!=-1?r="MacOS":u.indexOf("X11")!=-1?r="Unix":u.indexOf("Linux")!=-1&&(r="Linux");l=function(){for(var n="",t=0;t<16;t++)n+=s.charAt(Math.floor(Math.random()*s.length));return n};this.Asimov.CorrelationVector=function(){var t=l(),n=0,i=function(n){return n.getValue().length+2<=o?!0:!1},r=function(){return t.length+1+(n+1+"").length<=o?!0:!1};this.getValue=function(){return t.concat(".",n)};this.setValue=function(i){if(Asimov.CorrelationVector.isValid(i)){var r=i.lastIndexOf(".");t=i.substr(0,r);n=parseInt(i.substr(r+1),10)}else throw"Cannot set invalid correlation vector value";return t.concat(".",n)};this.extend=function(){return i(this)&&(t=t.concat(".",n),n=0),this.getValue()};this.increment=function(){return r()&&(n=n+1),this.getValue()}};a=new RegExp("^["+s+"]{16}(.[0-9]+)+$");this.Asimov.CorrelationVector.isValid=function(n){return a.test(n)&&n.length<=o};this.Asimov.cv=new this.Asimov.CorrelationVector;var y=function(){return n.jQuery?!n.JSON||!n.JSON.stringify?(t("Unable to write event: the global JSON.stringify method does not exist"),!1):i?i=="XDomainRequest"&&n.Asimov.uploadUrl&&n.Asimov.uploadUrl.indexOf(window.location.protocol)!=0?(t("Unable to write event: CORS requests are not supported cross-protocol in this browser"),!1):!0:(t("Unable to write event: CORS not supported in this browser"),!1):(t("Unable to write event: jQuery is not present"),!1)},h=function(n,i){t("Failure sending data to vortex: "+i)},c=function(){n.console&&n.console.log&&n.console.log("JSLL: Success sending data to vortex")},p=function(){t("Failure sending data to vortex using XDomainRequest")},t=function(t){n.console&&n.console.error&&n.console.error("JSLL: "+t)},f=function(n,t){if(n=="string")return typeof t=="string"||t instanceof String||t instanceof Date;if(n=="bool")return typeof t=="boolean"||t instanceof Boolean;if(!(typeof t=="number")||t instanceof Number)return!1;if(n=="uint8"){if(t<0||t>255||t%1!=0)return!1}else if(n=="uint16"){if(t<0||t>65535||t%1!=0)return!1}else if(n=="uint32"){if(t<0||t>4294967295||t%1!=0)return!1}else if(n=="uint64"){if(t<0||t>18446744073709551615||t%1!=0)return!1}else if(n=="int8"){if(t<-128||t>127||t%1!=0)return!1}else if(n=="int16"){if(t<-32768||t>32767||t%1!=0)return!1}else if(n=="int32"){if(t<-2147483648||t>2147483647||t%1!=0)return!1}else if(n=="int64"){if(t<-9223372036854775808||t>9223372036854775807||t%1!=0)return!1}else if(n=="float"){if(t<-3402823e32||t>3402823e32)return!1}else if(n=="double"&&(t<-17976931348623157e292||t>17976931348623157e292))return!1;return!0},v=function(n,i,r){for(var u,e,a,s,y,o,p,w,b,c,h=i.fields,l=0;l<h.length;l++){if(u=h[l],e=r[u.name],e===null||e===undefined){if(u.req)return t("Missing required property: "+u.name),!1;continue}if(u.type=="map"){a={};for(s in e){if(!f(u.key,s))return t("A key in the map was of the wrong type: "+u.name),!1;if(!f(u.element,e[s]))return t("A value in the map was of the wrong type: "+u.name),!1;a[s]=e[s]}n[u.name]=a}else if(u.type=="list"||u.type=="set"){if(y=[],Object.prototype.toString.call(e)==="[object Array]")for(o=0;o<e.length;o++){if(e[o]!=null&&!f(u.element,e[o]))return t("The list contains a value of the wrong type: "+u.name),!1;y[o]=e[o]}else return t("The "+u.type+" "+u.name+" was not an array as expected"),!1;n[u.name]=y}else if(u.type=="struct"){if(p={},!v(p,u.def,e))return!1;n[u.name]=p}else{if(!f(u.type,e))return t("Property is the wrong type: "+u.name),!1;n[u.name]=e}}for(w in r){for(b=!1,c=0;c<h.length;c++)if(h[c].name==w){b=!0;break}b||t("An unexpected property was found in the event content and dropped: "+w)}return!0};this.Asimov.writeEvent=function(t){var u,s,l,a,e,o,v,r,f;if(t&&y()){if(u=[],n.jQuery.isArray(t))for(s=0;s<t.length;s++)l=n.Asimov._validateAndTranslateEvent(t[s]),l.success&&u.push(l.event);else a=n.Asimov._validateAndTranslateEvent(t),a.success&&u.push(a.event);if(u.length!=0){for(e="",o=0;o<u.length;o++)o>0&&(e+="\n"),e+=n.JSON.stringify(u[o]);i==="jQuery"?(v={accepts:{text:"application/json"},url:n.Asimov.uploadUrl,type:"post",dataType:"text",cache:!1,data:e,crossDomain:!0,headers:{"Content-Type":"application/x-json-stream"}},r=window.jQuery.ajax(v),r.fail(h),r.fail?r.fail(h):r.error(h),r.done?r.done(c):r.success(c)):i==="XDomainRequest"&&(f=new XDomainRequest,f.onload=c,f.onerror=function(){p(f)},f.open("post",n.Asimov.uploadUrl),f.send(e))}}};this.Asimov._validateAndTranslateEvent=function(n){var u={},s={},i={event:u,success:!1},o,f,l,h,c;if(!n)return t("Unable to write null event"),i;if(!n.name)return t("Unable to write event with missing name"),i;if(!e.hasOwnProperty(n.name))return t("Unable to write event: a schema for the event named {"+n.name+"} does not exist"),i;if(!n.content)return t("Unable to write event: the event is missing content"),i;o=e[n.name];for(f in o)if(f!=="name"){if(l=o[f],!n.content.hasOwnProperty(f))return t("Unable to write event: missing expected part: "+f),i;if(l.part=="C"?h=s:(h={},s.baseData=h,s.baseType=f),!v(h,l.def,n.content[f]))return i}for(c in n.content)o[c]&&o[c].part||t("An unexpected property was found in the event content and dropped: "+c);if(u.name=n.name,u.time=new Date,u.data=s,u.tags={},u.os=r,n.hasOwnProperty(this.correlationVectorTag))if(this.CorrelationVector.isValid(n[this.correlationVectorTag]))u.tags[this.correlationVectorTag]=n[this.correlationVectorTag];else return t("Unable to write event: The correlation vector value is invalid: "+n[this.correlationVectorTag]),i;else u.tags[this.correlationVectorTag]=this.cv.getValue();return i.success=!0,i};this.Asimov._registerSchemas=function(n){for(var t=0;t<n.length;t++)e[n[t].name]=n[t]}}(),function(){this.Asimov._registerSchemas([{name:"Microsoft.Mac.SelfAssist.BaseAction","Microsoft.Mac.SelfAssist.BaseAction":{part:"C",def:{fields:[{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.CallbackAction","Microsoft.Mac.SelfAssist.CallbackAction":{part:"C",def:{fields:[{name:"callbackTime",type:"string"},{name:"immediateCallbackDelay",type:"double"},{name:"errorCode",type:"string"},{name:"subjectName",type:"string"},{name:"countryCode",type:"string"},{name:"subjectId",type:"string"},{name:"interactionId",type:"string"},{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.ChatAction","Microsoft.Mac.SelfAssist.ChatAction":{part:"C",def:{fields:[{name:"agentID",type:"string"},{name:"activityID",type:"string"},{name:"subjectName",type:"string"},{name:"subjectId",type:"string"},{name:"chatId",type:"string"},{name:"pageHasFocus",type:"bool"},{req:!0,name:"isRatMode",type:"bool"},{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.KbArticleAction","Microsoft.Mac.SelfAssist.KbArticleAction":{part:"C",def:{fields:[{name:"actionName",type:"string"},{name:"title",type:"string"},{name:"locale",type:"string"},{name:"articleId",type:"string"},{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.PageAction","Microsoft.Mac.SelfAssist.PageAction":{part:"C",def:{fields:[{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.SearchAction","Microsoft.Mac.SelfAssist.SearchAction":{part:"C",def:{fields:[{name:"custom2",type:"string"},{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.SiteFeedback","Microsoft.Mac.SelfAssist.SiteFeedback":{part:"C",def:{fields:[{req:!0,name:"type",type:"string"},{req:!0,name:"comment",type:"string"},{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.SupportAppAction","Microsoft.Mac.SelfAssist.SupportAppAction":{part:"C",def:{fields:[{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Microsoft.Mac.SelfAssist.SupportMenuAction","Microsoft.Mac.SelfAssist.SupportMenuAction":{part:"C",def:{fields:[{req:!0,name:"link",type:"string"},{req:!0,name:"actionName",type:"string"},{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"custom1",type:"string"},{name:"visitId",type:"string"},{name:"enqueueId",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{req:!0,name:"userAgent",type:"string"},{req:!0,name:"server",type:"string"},{req:!0,name:"language",type:"string"},{req:!0,name:"locale",type:"string"},{req:!0,name:"isNative",type:"bool"},{name:"muid",type:"string"},{name:"puid",type:"string"},{name:"partnerId",type:"string"},{name:"flightId",type:"string"},{name:"description",type:"string"},{name:"route",type:"string"},{name:"visitId",type:"string"},{name:"custom1",type:"string"},{name:"parentCv",type:"string"},{name:"anid",type:"string"}]}}},{name:"SelfAssistPortal.IncomingApiEvent","Ms.Qos.IncomingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{name:"operationVersion",type:"string"},{name:"callerIpAddress",type:"string"},{name:"callerName",type:"string"},{name:"requestSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"SelfAssistPortal.IncomingApiEvent":{part:"C",def:{fields:[{req:!0,name:"serverActivityId",type:"string"},{name:"userId",type:"string"},{req:!0,name:"anid",type:"string"},{name:"muid",type:"string"},{name:"deviceId",type:"string"},{req:!0,name:"partnerId",type:"string"},{name:"userAgent",type:"string"},{name:"responseContent",type:"string"},{name:"description",type:"string"},{name:"flightId",type:"string"},{name:"isNative",type:"bool"},{name:"cookies",type:"string"}]}}},{name:"SelfAssistPortal.OutgoingApiEvent","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"SelfAssistPortal.OutgoingApiEvent":{part:"C",def:{fields:[{req:!0,name:"serverActivityId",type:"string"},{name:"userId",type:"string"},{req:!0,name:"anid",type:"string"},{name:"muid",type:"string"},{name:"deviceId",type:"string"},{req:!0,name:"partnerId",type:"string"},{name:"responseContent",type:"string"},{name:"description",type:"string"}]}}},{name:"SelfAssistPortal.SelfAssistWebServerEvent","SelfAssistPortal.SelfAssistWebServerEvent":{part:"C",def:{fields:[{req:!0,name:"serverActivityId",type:"string"},{req:!0,name:"clientActivityId",type:"string"},{req:!0,name:"module",type:"string"},{name:"userId",type:"string"},{name:"anid",type:"string"},{name:"muid",type:"string"},{name:"deviceId",type:"string"},{name:"errorCode",type:"uint32"},{name:"message",type:"string"}]}}},{name:"SelfAssistPortal.SelfAssistWebViewControllerEvent","Ms.Qos.IncomingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{name:"operationVersion",type:"string"},{name:"callerIpAddress",type:"string"},{name:"callerName",type:"string"},{name:"requestSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"SelfAssistPortal.SelfAssistWebViewControllerEvent":{part:"C",def:{fields:[{name:"serverActivityId",type:"string"},{name:"message",type:"string"}]}}}])}();app.run(["$rootScope","$location","compassService",function(n,t,i){n.$on("$routeChangeSuccess",function(r,u){i.fetchContent(t.path().substring(1));u&&u.data&&u.data.noIndex===!0&&n.$broadcast("NoIndex")})}]),function(){function t(n){return n!==null&&typeof n=="object"}var n=function(n){var i,r;if(n&&n.data)try{i=t(n.data)?n.data:JSON.parse(n.data);i.type==="$broadcast"&&i.name&&angular.element(document)&&angular.element(document).injector()&&(r=angular.element(document).injector().get("$rootScope"),r.$broadcast(i.name,i.args,n.source),r.$digest())}catch(u){console.error("Error parsing message as JSON: "+u)}};window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n)}(),function(n){n.service("ParentWindowBroadcaster",["$rootScope","$window","$log",function(n,t){function i(i){n.$on(i,function(n,r,f){t.window!==f&&u(i,r)})}function r(i,r){i.$on(r,function(i,u,f){t.window!==f&&n.$broadcast(r,u)})}function u(n,i){t.parent&&t.parent.postMessage(JSON.stringify({type:"$broadcast",name:n,args:i}),"*")}this.init=function(n,u){n.forEach(i);try{if(t&&t.parent&&t.parent.angular&&t.parent.angular.element(t.frameElement)){var f=t.parent.angular.element(t.frameElement).scope();f&&u.forEach(function(n){r(f,n)})}}catch(e){}};this.init([],[])}]).run(["ParentWindowBroadcaster",function(){}])}(angular.module(microsoft.support.moduleName));app.config(["$routeProvider","$locationProvider","$compileProvider",function(n,t,i){var u,f,r;html5mode=!!(window.history&&window.history.pushState);i.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob|ms-contact-support):/);html5mode||(u=document.getElementsByTagName("base")[0].href,f=location.href.replace(u,"").replace(location.hash,""),location.hash=location.hash||f);r=["$route","$location","chatStateService","clientConfig","nativeAppService",function(n,t,i){if(i.isReconnectValid()&&i.getChatEstablished()&&(n.current.params.subject||i.getSubject())){var r=n.current.params.subject?n.current.params.subject:i.getSubject();t.path("/contact/chat/"+r+"/")}}];n.when("/enterprise/",{resolve:{isChatInProgress:r},controller:"SupportMenuController",templateUrl:"/PartialViews/SupportMenu/Container.html",data:{noIndex:!0,isLandingPage:!0}}).when("/menu/",{resolve:{isChatInProgress:r},controller:"SupportMenuController",templateUrl:"/PartialViews/SupportMenu/Container.html",data:{noIndex:!0,isLandingPage:!0}}).when("/menu/:issueType?/:product?/:issue?/",{resolve:{isChatInProgress:r},controller:"SupportMenuController",templateUrl:"/PartialViews/SupportMenu/Container.html",data:{noIndex:!0}}).when("/partner/:partner/menu/",{resolve:{isChatInProgress:r},controller:"SupportMenuController",templateUrl:"/PartialViews/SupportMenu/Container.html",data:{noIndex:!0,isLandingPage:!0}}).when("/hoops/:channelType/:subject/",{controller:"HoopsController",templateUrl:"/PartialViews/Contact/HoursOfOperation/HoursOfOperation.html",data:{noIndex:!0}}).when("/chat/:subject/",{controller:"ChatController",templateUrl:"/PartialViews/Contact/Chat/Container.html",data:{noIndex:!0}}).when("/callback/:subject/",{controller:"CallbackController",resolve:{isScheduleCallback:function(){return!1}},templateUrl:"/PartialViews/Contact/Callback/Container.html",data:{noIndex:!0}}).when("/schedulecallback/:subject/",{controller:"CallbackController",resolve:{isScheduleCallback:function(){return!0}},templateUrl:"/PartialViews/Contact/Callback/Container.html",data:{noIndex:!0}}).when("/form/:id/:name/",{controller:"UnauthFormController",templateUrl:"/PartialViews/Contact/UnauthForm/Container.html",data:{noIndex:!0}}).when("/rat-phone",{controller:"PhoneScreenShareController",templateUrl:"/PartialViews/RATOverPhone/PhoneScreenShare.html",data:{noIndex:!0}}).when("/:langLocale/products/:productname/",{controller:"ProductHubController",templateUrl:"/PartialViews/Products/ProductHub.html"}).when("/:langLocale/kb/:articleId",{controller:"KbController",templateUrl:"/PartialViews/KB/Index.html",reloadOnSearch:!1}).when("/kb/:articleId",{resolve:{kbRedirect:["$location","$route","languageService",function(n,t,i){n.url(i.langLocale()+"/kb/"+t.current.params.articleId)}]}}).when("/:langLocale/gwt/:articleId",{controller:"GwtController",templateUrl:"/PartialViews/Gwt/Index.html"}).when("/gwt/:articleId",{resolve:{gwtRedirect:["$location","$route","languageService",function(n,t,i){n.url(i.langLocale()+"/gwt/"+t.current.params.articleId)}]}}).when("/:langLocale/allproducts",{controller:"AllProductsController",templateUrl:"/PartialViews/AllProducts/Index.html"}).when("/:langLocale/search",{controller:"SearchResultsController",templateUrl:"/PartialViews/Search/Results.html",data:{noIndex:!0}}).when("/",{resolve:{homeRedirect:["$location","languageService",function(n,t){n.url(t.langLocale())}]}}).when("/errors",{resolve:{error:["$rootScope",function(n){n.$broadcast("500Error",{reason:"Hit errors route"})}]},data:{noIndex:!0}}).when("/:langLocale",{templateUrl:"/PartialViews/Index.html",data:{isLandingPage:!0}}).otherwise({resolve:{refresh:["$route","$rootScope","$location","$log",function(n,t,i,r){t.$broadcast("404Error",i.url());r.log("hit otherwise statement for route: ",n)}]}});t.html5Mode(html5mode)}]),function(n){n.service("seoService",["$http","$rootScope","$window","$timeout",function(n,t,i,r){function c(){u=u||n.pendingRequests.length;u&&!n.pendingRequests.length&&r(function(){u&&!n.pendingRequests.length&&(i.callPhantom(),h())},200)}function s(n,t){var r=t&&t.reason||"Page not found";i.callPhantom({error:!0,reason:r});h()}function h(){f();e();o()}var u=!1,f,e,o;typeof i.callPhantom=="function"&&(f=t.$watch(function(){return n.pendingRequests.length},c),e=t.$on("500Error",s),o=t.$on("404Error",s))}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("F1FooterController",["$rootScope","$scope","compassService",function(n,t,i){function r(){var n=i.getF1Footer();n&&(t.viewlinkfarm=n.f1FooterView)}t.reset=function(){r()};t.reset();t.$on("CompassContentReady",function(){r()})}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("FeedbackController",["$rootScope","$scope","compassService",function(n,t,i){t.feedbackWizard={};t.feedbackText={};t.feedbackWizard.reset=function(){t.feedbackWizard.show=!1;t.feedbackWizard.type="suggestion";t.feedbackWizard.comment=""};t.feedbackWizard.reset();t.feedbackWizard.toggle=function(){t.feedbackWizard.show=!t.feedbackWizard.show;t.feedbackWizard.show&&setTimeout(function(){$("#feedback-wizard textarea").first().focus()})};t.feedbackWizard.submit=function(i){i&&(n.$broadcast("SiteFeedback",t.feedbackWizard),t.feedback.$setPristine());t.feedbackWizard.reset()};var r=function(){var n=i.getFeedbackCtrl();n&&(t.feedbackText=n)};r();t.$on("CompassContentReady",function(){r()})}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("L0HeaderController",["$rootScope","$scope","$sce","$window","clientConfig","compassService","authenticationHelperService",function(n,t,i,r,u,f,e){var o=function(){t.userDisplayName=null;t.signInLink=i.trustAsHtml(u.RpsSignInInfo.SignInLink);t.$on("UserSignedIn",function(){t.userDisplayName=u.authInfo.displayName;t.signInLink=i.trustAsHtml(u.RpsSignInInfo.SignOutLink)});t.$on("UserSignedOut",function(){t.userDisplayName=null;t.signInLink=i.trustAsHtml(u.RpsSignInInfo.SignInLink)})};t.$on("UserSignedIn",function(){if(r&&r.msCommonShell){var t=r.msCommonShell,n=e.getShellOptions();n.meControlOptions.userData.firstName=u.authInfo.firstName;n.meControlOptions.userData.lastName=u.authInfo.lastName;n.meControlOptions.userData.memberName=u.authInfo.displayName;n.meControlOptions.userData.cid=u.authInfo.cid;n.meControlOptions.userData.authenticatedState=t.AuthState.SignedIn;t.load(n)}});t.$on("UserSignedOut",function(){if(r&&r.msCommonShell){var n=r.msCommonShell;n.load(e.getShellOptions())}});o()}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("languaugeselector",["$rootScope",function(){return{restrict:"A",link:function(n){$(document).ready(function(){$('a[id="locale-picker-link"]').on("click",function(){n.$broadcast("languageSelectorClicked");n.$digest()})})}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("SelfHostFeedbackController",["$scope","$window","$http","$location","clientConfig","compassService","surveyCookieService",function(n,t,i,r,u,f,e){var o=function(){var u=e.setSurveyCookie(),t=f.getSelfhostFeedback(),i;t&&(n.viewfeedback=t,i=t.selfHostFeedbackEmailBody,i=i.replace(/(\n)+/g,"%0D%0A"),t.selfHostFeedbackEmailBody=i,n.currentUrl="%0D%0AUrl: "+r.absUrl(),n.icon=String.fromCharCode("0x"+t.selfHostFeedbackIcon))};o();n.$on("CompassContentReady",function(){o()})}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("surveyCookieService",["$document",function(n){this.setSurveyCookie=function(){var t=this.getCookie("msresearch"),n="",i=(new Date).getTime(),r="",u,f,e;return(t?(u={},t.split(",").forEach(function(n){var t=n.split(":"),i;t[1]&&(u[t[0]]=t[1]);i=t[0].toString();i.indexOf("lastinvited")>-1&&(r=t[1])}),f='"lastinvited":'+r+",",e='"lastinvited":'+i+",",n=t.replace(f,e),this.setCookie("msresearch",n)):(n='"lastinvited":'+i+",",n='{ "version": "5.0", "state": { "name": "IDLE", "url": undefined, "timestamp": '+i+' }, "lastinvited": '+i+', "userid": "", "vendorid": 1, "surveys": [""], "graceperiod": 5, "trackertimestamp": 0 }',this.setCookie("msresearch",n)),n!=t)?!0:!1};this.getSurveyCookie=function(){return this.getCookie("msresearch")||""};this.setCookie=function(t,i){n[0].cookie=t+"="+i+";expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};this.getCookie=function(t){return t?decodeURIComponent(n[0].cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("authenticationHelperService",["$window","$rootScope","$location","$timeout","clientConfig","osService","languageService","nativeAppService",function(n,t,i,r,u,f,e,o){function h(n,t){var r,e;n?(r=$(u.RpsSignInInfo.SignInLink).attr("href"),e="wreply"):(r=$(u.RpsSignInInfo.SignOutLink).attr("href"),e="ru");var o=s(r),h=s(i.absUrl()),c=s(o[e]);return $.each(c,function(n,t){h[n]=t}),o[e]=encodeURI(i.absUrl().substring(0,i.absUrl().indexOf(i.path())+i.path().length)+"?"+$.param(h)),n&&(f.isMobile()||t)&&(o.pcexp="false"),r.substring(0,r.indexOf("?")+1)+$.param(o)}function c(n,i){if(u.authInfo.authStatus()===2){var f=function(){u.authInfo.isLoggedIn()?n&&n():t.$broadcast("ProcessUserSignIn",i)},e=r(function(){f()},5e3);t.$on("AuthStatusChange",function(){r.cancel(e);f();t.$apply()})}else u.authInfo.authStatus()===1?n&&n():t.$broadcast("ProcessUserSignIn",i)}var s=function(n){for(var i={},r=n.substring(n.indexOf("?")+1),u=/([^&=]+)=([^&]*)/g,t;t=u.exec(r);)i[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return i};this.getUpdatedAuthenticationUrl=function(n,t){return h(n,t)};this.signIn=function(n){c(n,!1)};this.mobileSignIn=function(n){c(n,!0)};this.getShellOptions=function(){var i=n.msCommonShell;return{meControlOptions:{rpData:{msaInfo:{signInUrl:jQuery(u.RpsSignInInfo.SignInLink).attr("href"),signOutUrl:jQuery(u.RpsSignInInfo.SignOutLink).attr("href"),meUrl:u.RpsSignInInfo.MeControlLink}},userData:{idp:i.SupportedAuthIdp.MSA,firstName:null,lastName:null,memberName:null,cid:null,authenticatedState:i.AuthState.NotSignedIn},events:{onSignIn:function(){t.$broadcast("ProcessUserSignIn")},onBeforeSignOut:function(){t.$broadcast("ProcessUserSignOut")}}}}};t.$on("ProcessUserSignIn",function(t,r){o.isNative()?o.signInUser(i.absUrl()):n.location=h(!0,!!r)});t.$on("ProcessUserSignOut",function(){n.location=h(!1,!1)})}])}(angular.module(microsoft.support.moduleName));app.directive("compile",["$compile","$sanitize",function(n){return{restrict:"A",transclude:!0,scope:{compile:"="},link:function(t,i){t.$watch(function(n){return n.compile},function(r){if(r)try{i.html(r);n(i.contents())(t)}catch(u){console.log("Does not compile",u)}})}}}]);app.directive("debug",["$routeParams",function(n){return{restrict:"A",scope:{debug:"="},link:function(t,i,r){t.enabled=n.debug;t.name=r.debug},template:'<pre ng-if="enabled"> {{name}}: {{debug | json}}<\/pre>'}}]),function(n){n.directive("focusContent",["$timeout","focusContentService",function(n,t){return{restrict:"A",scope:{name:"@",condition:"@"},link:function(i,r){function f(t){t===i.name&&u&&n(function(){r[0].focus()})}var u=!1;i.$on("FocusContent",function(n,t){f(t.name)});i.$watch("condition",function(n){u=n&&n.toLowerCase()==="true"||typeof i.condition=="undefined"?!0:!1;f(i.name)});f(t.activeTarget)}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("focusContentService",["$rootScope",function(n){this.activeTarget=null;this.focus=function(t){n.$broadcast("FocusContent",{name:t});this.activeTarget=t}}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).filter("linkify",function(){return function(n){var t,i=n,u,r;if(n&&n.toLowerCase().indexOf("<a")!==-1&&n.toLowerCase().indexOf("<\/a>")!==-1){do if(t=n.match(/<a.*?(?=>)/i),t!==null){if(r=t.toString(),r.toLowerCase().indexOf("target")!==-1){u=n.match(/target\=.*?(?=\s|>)/i);i=i.replace(u,"target='_blank'");n=n.replace(t,"");continue}i=i.replace(t,t+" target='_blank'");n=n.replace(t,"")}while(t!==null)}else if(n)do t=n.match(/^(?:(?:https?):\/\/?|www\.)[a-zA-Z0-9+&@#/%=~_|$?!:.-]*[a-zA-Z0-9+&@#/%=~_|$]/),t!==null&&(r=t.toString(),r.indexOf("http")!==0&&(r="http://"+r),i=i.replace(t,"<a href='"+r+"' target='_blank'>"+t+"<\/a>"),n=n.replace(t,""));while(t!==null);return i}});angular.module(microsoft.support.moduleName).directive("loadingSpinner",["$rootScope","$timeout","qosTelemetryService",function(n,t,i){return{restrict:"A",templateUrl:"/PartialViews/Common/LoadingSpinner.html",scope:{content:"="},link:function(r,u,f){function c(){f.timeout&&(e=t(a,f.timeout));f.delay?o=t(l,f.delay):r.isStarted=!0;f.message&&(s=i.createEvent("/app/"+f.message));f.type==="bar"?v():y()}function l(){r.isStarted=!0}function a(){f.message&&n.$broadcast(f.message,r.content);s&&s.reject("Timeout after "+f.timeout+"seconds")}function v(){r.barClasses["indeterminate-bar"]=!0;r.indicatorClasses["indeterminate-indicator"]=!0;r.isBar=!0}function y(){r.progressClasses.ring=!0;r.indicatorClasses["indeterminate-ring"]=!0;f.size==="small"||(f.size==="large"?(r.indicatorClasses["indeterminate-large"]=!0,r.progressClasses["ring-large"]=!0):(r.indicatorClasses["indeterminate-medium"]=!0,r.progressClasses["ring-medium"]=!0))}function h(){e&&(t.cancel(e),e=null);o&&(t.cancel(o),o=null)}r.isStarted=!1;r.progressClasses={};r.barClasses={};r.indicatorClasses={};r.isBar=!1;var e,o,s;r.$on("$destroy",h);u.on("$destroy",h);c()}}}]),function(n){n.service("localStorageService",["$window","$log","clientConfig","currentLanguageService",function(n,t,i,r){var f="cacheConfigKey",u=n&&n.navigator&&n.navigator.cookieEnabled&&n.localStorage,e,o;try{n.localStorage.setItem("storageTest","");n.localStorage.removeItem("storageTest","")}catch(s){u=!1}u||t.error("Local storage not supported");e=function(){var n={};return n.language=r.getLang().toLowerCase(),i&&i.SiteContentConfig&&i.SiteContentConfig.BuildVersion&&(n.buildVersion=i.SiteContentConfig.BuildVersion),n};o=function(){var t,r,i;if(u&&n.localStorage[f]){t=JSON.parse(n.localStorage[f]);r=e();for(i in t)if(t[i]!=r[i])return!1;return!0}return!1};this.getCacheContent=function(t){if(u&&n.localStorage[t]){if(!o())return this.invalidateCache(),null;var r=JSON.parse(n.localStorage[t]),f=(new Date).getTime()-new Date(r.timestamp);return!r.noExpiration&&f>i.SiteContentConfig.ClientCompassCacheTimeout?(localStorage.removeItem(t),null):r.data}return null};this.commit=function(t,r){if(u&&i.SiteContentConfig&&i.SiteContentConfig.ClientCompassCachingEnabled&&i.SiteContentConfig.ClientCompassCacheTimeout){var o={data:r,timestamp:(new Date).getTime()};n.localStorage.setItem(f,JSON.stringify(e()));n.localStorage.setItem(t,JSON.stringify(o))}};this.commitWithoutExpiration=function(t,i){if(u){var r={data:i,timestamp:(new Date).getTime(),noExpiration:!0};n.localStorage.setItem(f,JSON.stringify(e()));n.localStorage.setItem(t,JSON.stringify(r))}};this.invalidateCache=function(){u&&i.SiteContentConfig&&i.SiteContentConfig.ClientCompassCachingEnabled&&i.SiteContentConfig.ClientCompassCacheTimeout&&localStorage.clear()}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("locationService",["$window","$location",function(n,t){this.getCurrentPath=function(){return t.url().replace(t.hash(),"")};this.setPathAndReload=function(t){n.location=t}}])}(angular.module(microsoft.support.moduleName)),function(n){n.value("contactCommands",{notifyChatStarted:"NotifyChatStarted",notifyChatEnded:"NotifyChatEnded",angularJsReady:"angularjsready",notifyAppClosingComplete:"notifyappclosingcomplete",showtoast:"showtoast",notifychatenqueue:"notifychatenqueue",notifychatdequeue:"notifychatdequeue",signInUser:"signinuser",appStartContext:"appstartcontext",forwardToAgent:"forwardtoagent",sharingSessionConnected:"sharingsessionconnected",sharingSessionFailed:"sharingsessionconnectionfailed",notifyAppClosing:"notifyappclosing",signInFailed:"signinfailed",getAppContext:"getappcontext",beginSharing:"beginsharing",endSharing:"endsharing",pauseSharingByAgent:"pausesharingbyagent",resumeSharingByAgent:"resumesharingbyagent",clearCanvas:"clearcanvas",changeBrushColor:"changebrushcolor",changeBrushSize:"changebrushsize",setSharingMode:"setsharingmode",endSharingByUser:"endsharingbyuser",pauseSharingByUser:"pausesharingbyuser",resumeSharingByUser:"resumesharingbyuser"});n.value("contactMessageTypes",{requestResponse:"requestresponse",userRequest:"userrequest"});n.service("nativeAppService",["$log","$window","$rootScope","$cookieStore","$location","contactCommands","contactMessageTypes","chatStateService",function(n,t,i,r,u,f,e,o){function l(n,t){t&&(n={command:f.forwardToAgent,context:n});a(n,!0)}function a(n,r){n&&n.command&&(r&&n.context?i.$broadcast("ForwardToAgent",JSON.stringify(n.context)):t&&t.external&&"notify"in t.external&&(i.$broadcast("AppActionStart",n.command),t.external.notify(JSON.stringify(n))))}function p(t){switch(t.command){case f.appStartContext:return t.context&&(i.$broadcast("AppStartContext",t.context),ut(t.context.EffectiveCapabilities),o.setAppStartContext(t.context)),!0;case f.forwardToAgent:return g(t.context)||l(t,!1),w(t.context),!0;case f.signInFailed:return i.$broadcast("NativeSignInFailed"),!0;case f.notifyAppClosing:return i.$broadcast("NativeAppClosing"),!0;default:n.error("Unknown App Command: '"+t.command+"' received")}return!1}function w(t){switch(t.command){case e.userRequest:case e.requestResponse:return nt(t.command,t.context)?tt(t.command,t.context):it(t.command,t.context),!0;default:n.error("Unknown App Message Type: '"+t.command+"' received")}return!1}function b(t){switch(t.command){case f.getAppContext:return s.sendAgentRequestResponse(f.getAppContext,!0,"App start context in custom field","",o.getAppStartContext()),!0;case f.beginSharing:return t.context&&t.context.promptuser?i.$broadcast("ChatScreenShareRequest",t):(i.$broadcast("ChatScreenShareReconnect"),s.sendAppCommand(t)),!0;case f.endSharing:case f.pauseSharingByAgent:case f.resumeSharingByAgent:case f.clearCanvas:case f.changeBrushColor:case f.changeBrushSize:return s.sendAppCommand(t),!0;case f.setSharingMode:return i.$broadcast("SetSharingModeRequest",t.context.sharingmode),s.sendAppCommand(t),!0;default:n.error("Unknown Agent Command: '"+t.command+"' received")}return!1}function k(n){return n&&n.requestname}function d(n){return n&&n.responsename&&n.success}function g(n){if(n&&n.command&&n.context){var t=v(n.command,n.context);return t===f.sharingSessionFailed}return!1}function nt(n,t){switch(n){case e.userRequest:return k(t)&&s.isUnderstoodCommand(t.requestname);case e.requestResponse:return d(t)&&s.isUnderstoodCommand(t.responsename)}return!1}function v(n,t){switch(n){case e.userRequest:return t.requestname;case e.requestResponse:return t.responsename}return null}function tt(n,t){var r=v(n,t);i.$broadcast("AppActionEnd",{command:r,success:!0});switch(r){case f.sharingSessionConnected:return i.$broadcast("ChatScreenShareEstablished"),!0;case f.sharingSessionFailed:return i.$broadcast("ChatScreenShareConnectFailed"),!0;case f.endSharing:case f.endSharingByUser:return i.$broadcast("ChatScreenShareClosed"),!0;case f.pauseSharingByAgent:case f.pauseSharingByUser:return i.$broadcast("ToggleScreenShare",!0),!0;case f.resumeSharingByAgent:case f.resumeSharingByUser:return i.$broadcast("ToggleScreenShare",!1),!0;case f.setSharingMode:return i.$broadcast("SetSharingMode"),!0;case f.beginSharing:case f.clearCanvas:case f.changeBrushColor:case f.changeBrushSize:return!0}return!1}function it(t,r){var u=v(t,r);i.$broadcast("AppActionEnd",{command:u,success:!1});switch(u){case f.beginSharing:case f.pauseSharingByUser:case f.resumeSharingByUser:return i.$broadcast("ChatScreenShareError",u),n.error("Native Command: "+r.command+" failed with context: "+JSON.stringify(r.context)),!0;case f.endSharing:case f.pauseSharingByAgent:case f.resumeSharingByAgent:case f.clearCanvas:case f.changeBrushColor:case f.changeBrushSize:case f.setSharingMode:return!0}return!1}function rt(){document.cookie=y.nativeCookie+"="+h+";path=/"}function ut(n){n&&n.map(function(n){typeof c[n]!="undefined"&&(c[n]=!0)})}var y={nativeCookie:"isNative"},c={ScreenSharing:!1,Annotation:!1,FullControl:!1,PauseSharing:!1},s=this,h;this.setNative=function(n){var t=h;h=n;h!==t&&i.$broadcast("NativeCookieUpdate");rt()};this.isNative=function(){return u&&u.search()&&typeof u.search().isNative!="undefined"?u.search().isNative:h||!1};this.hasCapability=function(n){return!!c[n]};this.isUnderstoodCommand=function(n){for(var t in f)if(f[t]===n)return!0;return!1};this.receiveCommand=function(n,t){return h&&n&&n.command?t?b(n):p(n):!1};this.signInUser=function(n){a({command:f.signInUser,context:{successUrl:n}},!1)};this.sendAppCommand=function(n){h&&a(n,!1)};this.sendAgentUserRequest=function(n,t){l({command:e.userRequest,context:{requestname:n,data:t||null}},!0)};this.sendAgentRequestResponse=function(n,t,i,r,u){l({command:e.requestResponse,context:{responsename:n,success:t,message:i,errorcode:r,custom:u||null}},!0)};i.$on("CommandMessageReceived",function(n,t){s.receiveCommand(t,!0)});i.$on("ChatSessionEstablished",function(){s.sendAppCommand({command:f.notifyChatStarted})});i.$on("ChatSessionClosed",function(){s.sendAppCommand({command:f.notifyChatEnded})});i.$on("NotifyAppClosingComplete",function(){s.sendAppCommand({command:f.notifyAppClosingComplete})});i.$on("ShowToast",function(n,t){s.sendAppCommand({command:f.showtoast,context:{text:t}})});i.$on("EnqueueChatSuccess",function(){s.sendAppCommand({command:f.notifychatenqueue})});i.$on("ChatDisengageSuccess",function(){s.sendAppCommand({command:f.notifychatdequeue})});i.$on("AngularJsReady",function(){s.sendAppCommand({command:f.angularJsReady})});u.search()&&typeof u.search().isNative!="undefined"?this.setNative(u.search().isNative):h=r.get(y.nativeCookie)}])}(angular.module(microsoft.support.moduleName));window&&(window.selfAssistWeb=window.selfAssistWeb||{},window.selfAssistWeb.receiveCommand=function(n){return angular.element(document).injector().get("nativeAppService").receiveCommand(n,!1).toString()});angular.module(microsoft.support.moduleName).directive("navigationConfirmation",["$window","$rootScope","rccService","chatStateService",function(n,t,i,r){return{restrict:"A",scope:{message:"&",condition:"&"},link:function(t){function u(n){if(t.condition())return(n||window.event).returnValue=t.message(),t.message()}function f(){i.endChat()}function e(){r.getChatEstablished()||i.endChat()}$(n).bind("beforeunload",u);$(n).bind("onbeforeunload",u);$(n).bind("beforeunload",e);$(n).bind("onbeforeunload",e);$(n).bind("unload",f);$(n).bind("onunload",f);t.$on("$destroy",function(){$(n).unbind("beforeunload",u);$(n).unbind("onbeforeunload",u);$(n).unbind("unload",f);$(n).unbind("onunload",f)})}}}]);angular.module(microsoft.support.moduleName).filter("objectOrderBy",function(){return function(n,t,i){var r=[];for(var u in n)n[u]!==undefined&&r.push(n[u]);return r.sort(function(n,i){return n[t]>i[t]?1:-1}),i&&r.reverse(),r}}),function(n){n.controller("OnlineController",["$scope","compassService",function(n,t){function i(){n.offlineMessage=t.getOfflineMessage()}n.$on("CompassContentReady",function(){i()});i()}])}(angular.module(microsoft.support.moduleName));app.run(["$window","$rootScope",function(n,t){t.online=navigator.onLine?!0:!1;n.addEventListener&&(n.addEventListener("online",function(){t.online=!0;t.$apply();t.$broadcast("ClientReconnected")}),n.addEventListener("offline",function(){t.online=!1;t.$apply()}))}]),function(n){n.service("osService",["$window",function(n){var i,r={"Windows 2000":["Windows NT 5.0"],"Windows XP":["Windows NT 5.1"],"Windows 2003":["Windows NT 5.2"],WindowsVista:["Windows NT 6.0"],"Windows 7":["Windows NT 6.1","Windows 7"],"Windows 8":["Windows NT 6.2","Windows 8"],"Windows 8.1":["Windows NT 6.3","Windows 8"],Mac:["Mac"],X11:["Unix"],Linux:["Linux"]},t={Android:function(){return n.navigator.userAgent.match(/Android/i)},BlackBerry:function(){return n.navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return n.navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return n.navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return n.navigator.userAgent.match(/IEMobile/i)},Other:function(){return n.navigator.userAgent.indexOf("Mobi")>=0},any:function(){return t.Android()||t.BlackBerry()||t.iOS()||t.Opera()||t.Windows()||t.Other()}};this.getOS=function(){return i};this.isMobile=function(){return!!t.any()};this.determineOS=function(){var f=n.navigator.platform,u=n.navigator.userAgent,t,i;for(t in r)if(i=r[t].filter(function(n){return u.indexOf(n)>-1}),i.length)return t;return"Other"};this.isWindows=function(){return n.navigator.platform.indexOf("Win")>=0};this.is64bitWindows=function(){return n.navigator.userAgent.indexOf("WOW64")>-1||n.navigator.platform=="Win64"};i=this.determineOS();this.isCorsEnabled=function(){return n.navigator.userAgent.indexOf("MSIE 8.0")>-1||n.navigator.userAgent.indexOf("MSIE 9.0")>-1?!1:!0}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("PageController",["$scope","$window","$location","compassService","osService",function(n,t,i,r,u){function e(){n.errorStatus=t.navigator.cookieEnabled?null:"cookies"}n.title="";n.noIndex=!1;var f=function(){var t=r.getPageInfo();t&&(n.title=t.pageTitle,n.alertBanner=t.alertBanner,t.alertBannerLink&&t.alertBannerLink.linkText&&t.alertBannerLink.linkUrl&&(n.alertBannerLink='<a id="alert-banner-link" href="'+t.alertBannerLink.linkUrl+'">'+t.alertBannerLink.linkText+"<\/a>"),t.alertBannerLink2&&t.alertBannerLink2.linkText&&t.alertBannerLink2.linkUrl&&(n.alertBannerLink2='<a id="alert-banner-link-2" href="'+t.alertBannerLink2.linkUrl+'">'+t.alertBannerLink2.linkText+"<\/a>"))};n.getCv=function(){return t&&t.Asimov&&t.Asimov.cv?t.Asimov.cv.getValue():null};n.reset=function(){n.isMobile=u.isMobile();f();e()};n.$on("UpdateTitle",function(t,i){n.title=i});n.$on("CompassContentReady",function(){f()});n.$on("NoIndex",function(){n.noIndex=!0});n.$on("500Error",function(){n.errorStatus||(n.errorStatus="500")});n.$on("404Error",function(){n.errorStatus||(n.errorStatus="404")});n.$on("$routeChangeStart",function(){n.errorStatus!=="cookies"&&(n.errorStatus=null);n.noIndex=!1});n.$on("$routeChangeSuccess",function(){var t;n.canonicalUrl=i.absUrl();(t=n.canonicalUrl.indexOf("?"))!==-1&&(n.canonicalUrl=n.canonicalUrl.substr(0,t))});n.reset()}])}(angular.module(microsoft.support.moduleName));app.directive("scrollTo",["$location","$anchorScroll","$log","$timeout",function(n,t,i,r){return{restrict:"A",link:function(i,u,f){u.bind("click",function(){r(function(){f&&f.location&&(n.hash(f.location),t())})})}}}]);app.directive("starRating",["compassService",function(n){function t(){var t=n.getChatSurvey();return t?t.starRating:null}return{restrict:"A",templateUrl:"/PartialViews/Common/StarRating.html",scope:{ratingValue:"=value",max:"=?"},link:function(n){n.max=n.max||5;n.stars=new Array(n.max);n.starRatingText=t();n.rate=function(t){n.ratingValue=t+1};n.preview=function(t){n.previewValue=t+1}}}}]),function(n){n.controller("CallbackController",["$scope","$rootScope","$log","$routeParams","$location","$sanitize","$filter","clientConfig","chatStateService","rccService","languageService","compassService","phoneNumberService","waitTimeService","isScheduleCallback",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){function w(){n.callback=l.getCallback();n.status.waitingOnCompass=!n.callback}function p(t){n.callInfo.currentError=t;n.$apply(function(){n.callInfo.templateUrl="/PartialViews/Contact/Callback/Error.html"});n.loadingTimes=!1}function b(n){var i=[],t,r;for(i.push(new Date),t=1;t<n;t++)r=new Date((new Date).getTime()+t*864e5),r.setHours(0,0,0,0),i.push(r);return i}function k(t){var f=n.callInfo.date.getDate(),u=[],i,r;for(i in t)r=new Date(t[i]),r.getDate()===f&&u.push({time:t[i],dateobject:r});return u}n.hoops={};n.config={templateUrl:"/PartialViews/Contact/Callback/Callback.html",hoopsEnabled:o.ChatConfig.AllowHoursOfOperation,timeout:o.ChatConfig.ChatDefaultTimeout};n.reset=function(){n.awaitingResponse=!0;n.isScheduleCallback=y;n.status={waitingOnHoops:!1,waitingOnRcc:!0,waitingOnCompass:!0};n.callInfo={};n.callInfo.number="";n.callInfo.invalidNumber=!1;n.callInfo.times=[];n.callInfo.availableDates=n.isScheduleCallback?b(7):[];n.callInfo.date=n.callInfo.availableDates[0];n.callInfo.currentError="";n.callInfo.disableTimeSelect=!0;h.init(function(){n.awaitingResponse=!1;n.status.waitingOnRcc=!1;n.config.hoopsEnabled&&!n.isScheduleCallback?(n.status.waitingOnHoops=!0,h.isWithinOperatingHours(s.getSubject(),"callback").then(function(t){n.status.waitingOnHoops=!1;t.isOpen?n.initCallback():u.path("/hoops/callback/"+s.getSubject())})):n.initCallback()});w()};n.initCallback=function(){n.callInfo.availableCountries=a.populateDropdown();n.updateCountry(c.locale());n.callInfo.templateUrl=n.config.templateUrl;n.isScheduleCallback&&n.getCallbackTimes()};n.updateCountry=function(t){n.callInfo.countryCode=a.selectCountryCode(t);n.callInfo.placeholder=a.getCurrentMask();n.getValidNumber()};n.getCallbackTimes=function(){n.loadingTimes=!0;n.callInfo.times=[];n.callInfo.disableTimeSelect=!0;h.getCallbackTime(n.callInfo.date.toISOString().substring(0,19)+"Z",96,s.getSubject())};n.requestCall=function(i){if(n.getValidNumber(),!n.callInfo.invalidNumber){t.$broadcast("ButtonClickedAndDisabled",i);n.awaitingResponse=!0;var r=n.callInfo.countryCode.code+" "+n.callInfo.number;n.isScheduleCallback?h.enqueueCallback(r,s.getSubject(),a.getCurrentLocale(),n.callInfo.time.time):h.enqueueCallback(r,s.getSubject(),a.getCurrentLocale())}};n.goToSuccess=function(){n.isScheduleCallback?(n.callInfo.displayDate=e("date")(n.callInfo.date,"fullDate"),n.callInfo.displayTime=e("date")(n.callInfo.time.dateobject,"shortTime"),n.loadingTimes=!1):n.callInfo.waitTime=v.getCallbackWaitTime();n.callInfo.number=a.avoidIEParser(n.callInfo.number);n.callInfo.templateUrl="/PartialViews/Contact/Callback/Success.html"};n.checkIfValidNumber=function(){var t=a.checkIfValidNumber(n.callInfo);t||(n.callInfo.invalidNumber=!1)};n.getValidNumber=function(){n.callInfo=a.getValidNumber(n.callInfo)};n.disableConfirm=function(){var t=n.callInfo.invalidNumber||!n.callInfo.number||n.callInfo.number.length===0||n.awaitingResponse;return n.isScheduleCallback&&(t=t||n.loadingTimes||n.callInfo.disableTimeSelect),t};n.$on("CompassContentReady",w);n.$on("CallbackPhoneValidation",function(t,i){i&&!i.isValid&&(n.currentError="invalidPhoneNumber",p())});n.$on("EnqueueCallbackSuccess",function(){n.awaitingResponse=!1;n.goToSuccess()});n.$on("EnqueueCallbackFailure",function(t,i){n.awaitingResponse=!1;i.errorCode==="CHANNEL_CONTACTSCHEDULED"?p("doubleCallback"):i.errorCode==="CHANNEL_CONTACTINVALID"?p("invalidPhoneNumber"):p()});n.$on("EnterCallbackQueueTimeout",function(){n.awaitingResponse=!1;p()});n.$on("CallbackPageTimeout",function(){n.isReady||(n.status.isScheduleCallback=n.isScheduleCallback,t.$broadcast("500Error",{reason:"Timeout occurred on a callback ASAP or schedule callback page",data:n.status}))});n.$on("GetCallbackTimeSuccess",function(t,i){n.callInfo.times=k(i.slots);n.callInfo.times.length===0?(n.callInfo.disableTimeSelect=!0,n.callInfo.times=[{dateobject:n.callback.scheduleCallback.noTimesAvailable}]):n.callInfo.disableTimeSelect=!1;n.callInfo.time=n.callInfo.times[0];n.loadingTimes=!1});n.$on("ScheduleCallbackTimesTimeout",function(){n.loadingTimes=!1;n.awaitingResponse=!1;p()});n.$watchCollection("status",function(t){var i=!1;t&&(i=!0,Object.keys(t).map(function(n){i=i&&!t[n]}));n.isReady=i});n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("phoneNumberService",["$rootScope","rccService","compassService",function(n,t,i){function h(){u=i.getSupportedLocales()||[s];e!==u.length&&(e=u.length,o=!1)}function f(n,i){i||(i="US");var r=t.validateNumber(n,i);return r?r:{isValid:!0,mask:"+1 XXX-XXX-XXXX",formattedContact:n}}var u,e,r,c,o,s={country:"United States",locale:"US"},l=0;this.init=function(){h()};this.getCurrentCountryCode=function(){return r&&r.code?r.code:"+1"};this.getCurrentLocale=function(){return r&&r.locale?r.locale:"US"};this.getCurrentCountry=function(){return r&&r.country?r.country:"United States"};this.getCurrentMask=function(){return r&&r.mask?r.mask:this.getMask("US")};this.getFormattedNumber=function(n,t){var i=f(n,t),e=i.formattedContact.indexOf("+")>-1,r=i.formattedContact.indexOf(" "),u;return e&&r>0&&(u=i.formattedContact.substring(r+1)),u};this.getCountryCode=function(n){var t=f("",n),i=t.mask.indexOf(" ");return i>0?t.mask.slice(0,i):"+1"};this.getMask=function(n){var t=f("",n),i=t.mask.indexOf(" ");return i>0?t.mask.slice(i).trim():"XXX-XXX-XXXX"};this.populateDropdown=function(){var n=this;return o||(u.forEach(function(t,i){t.code=n.getCountryCode(t.locale);t.mask=n.getMask(t.locale);t.display=t.code+" - "+t.country;t.locale==="US"&&(s=t,l=i)}),o=!0),u};this.selectCountryCode=function(n){n=n.toUpperCase();for(var t=0;t<e;t++)if(n===u[t].locale)return r=u[t],c=t,u[t];return s};this.checkIfValidNumber=function(n){return n.number.length!==0&&!f(n.number,this.getCurrentLocale()).isValid};this.getValidNumber=function(n){if(n.number.length<=0)return n;var t=f(n.number,this.getCurrentLocale());return t.isValid?(n.invalidNumber=!1,n.number=this.getFormattedNumber(t.formattedContact,this.getCurrentLocale())):n.invalidNumber=!0,n};this.avoidIEParser=function(n){return n.substring(0,1)+"<span class='hidden'>_<\/span>"+n.substring(1)};n.$on("CompassContentReady",h);this.init()}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("PhoneScreenShareController",["$rootScope","$scope","$timeout","$log","rccService","compassService","flightService","clientConfig","chatStateService","nativeAppService","contactCommands","agentChatService","chatSenderTypes","qosTelemetryService",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){function y(){t.content=f.getPasscode();t.content&&(t.status.waitingOnCompass=!1)}function p(){t.reconnectTimer||(t.reconnectTimer=i(function(){(t.showReconnectingMessage||t.showClientReconnectingMessage)&&(t.showReconnectingMessage=!1,t.showClientReconnectingMessage=!1,t.showDisconnectMessage=!0,v.createEvent(v.eventTypes.awasa.chatReconnectTimedOut).reject(),s.clearState(),u.endChat())},t.config.reconnectWaitTime))}function w(){t.showDisconnectMessage||t.showReconnectingMessage||t.showClientReconnectingMessage||t.reconnectTimer&&i.cancel(t.reconnectTimer)}t.config={timeout:o.ChatConfig.ChatDefaultTimeout,reconnectWaitTime:o.ChatConfig.ChatReconnectWaitTime,chatScreenShareEnabled:o.ChatConfig.AllowChatScreenShare&&h.hasCapability("ScreenSharing"),flightEnabled:e.isUserInFlight("rp")};t.reset=function(){t.status={waitingOnRcc:!0,waitingOnCompass:!0};t.isNative=h.isNative();t.hasValidPasscode=!1;t.failedConnect=!1;t.agent=null;t.waitingOnAgent=!1;t.displayChatScreenShare=!1;t.sharingScreen=!1;t.showClientReconnectingMessage=!1;t.showReconnectingMessage=!1;t.showDisconnectMessage=!1;t.messages=[];t.sessionId="";t.subjectId="";y();u.isRatMode()||u.toggleRatMode();u.init(function(){t.status.waitingOnRcc=!1})};t.connectToAgent=function(n){t.agent=n;n&&n.AgentId&&(t.failedConnect=!1,t.waitingOnAgent=!0,s.setAgent(n),s.setSubject(t.subjectId),u.enqueueChat({agentId:t.sessionId,ignoreAvailability:!0}))};t.cancel=function(){s.clearState();n.$broadcast("ChatBack")};t.$on("CompassContentReady",y);t.$on("PasscodeSuccess",function(n,i){t.hasValidPasscode=!0;t.waitingOnAgent=!0;t.sessionId=i.SessionId;t.subjectId=i.SubjectId;l.lookupAgent(i.ViewerId)});t.$on("ChatMessageReceived",function(n,i){(i.chatSender===a.SystemInfo||i.chatSender===a.SystemError)&&t.messages.push(i)});t.$on("AgentDataReady",function(n,i){t.connectToAgent(i)});t.$on("EnqueueChatFailure",function(n,i){t.failedConnect=!0;r.error("EunqueChatFailure was broadcast",JSON.stringify(i))});t.$on("ChatSessionEstablished",function(){t.waitingOnAgent=!1;t.$broadcast("ChatScreenShareRequest",{command:c.beginSharing})});t.$on("ChatSessionClosed",function(){t.displayChatScreenShare=!1;t.sharingScreen=!1});t.$on("ChatScreenShareRequest",function(){t.displayChatScreenShare=!0});t.$on("ChatScreenShareDenied",function(){t.displayChatScreenShare=!1});t.$on("ChatScreenShareClosed",function(){t.displayChatScreenShare=!1;t.sharingScreen=!1});t.$on("ChatScreenShareEstablished",function(){t.sharingScreen=!0});t.$on("MessageWindowTryAgain",function(){t.cancel()});t.$on("AgentDisconnected",function(){t.showClientReconnectingMessage||(t.showReconnectingMessage=!0);p()});t.$on("AgentReconnected",function(){t.showReconnectingMessage=!1;w()});t.$on("ChatChannelDisconnected",function(){t.showReconnectingMessage||(t.showClientReconnectingMessage=!0);p()});t.$on("ChatChannelReconnected",function(){t.showClientReconnectingMessage=!1;w()});t.$on("RATPhonePageTimeout",function(){t.isReady||n.$broadcast("500Error",{reason:"Timeout occurred on passcode page",data:t.status})});t.$on("$destroy",function(){u.isRatMode()&&u.toggleRatMode()});t.$watchCollection("status",function(n){var i=!1;n&&(i=!0,Object.keys(n).map(function(t){i=i&&!n[t]}));t.isReady=i});t.reset()}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).filter("timeslotDisplay",["$filter",function(n){return function(t){return t instanceof Date?n("date")(t,"shortTime"):t}}]),function(n){n.service("agentChatService",["$rootScope","contentApiService",function(n,t){var i=!1;this.lookupAgent=function(i){var r=t.getAgentById(i);r.then(function(t){t.data&&n.$broadcast("AgentDataReady",t.data)},function(){})};this.isAgentTyping=function(){return i};n.$on("AgentTyping",function(t,r){r!==i&&(i=r,n.$broadcast("ChatTyping",i))})}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("autoScrollContent",["$document","$interval","$q",function(n,t,i){function r(n,r){var u=i.defer(),f=(n.scrollHeight-$(n).scrollTop())/r*33,e=t(function(){var i=$(n).scrollTop();$(n).scrollTop(i+f);(i>=n.scrollHeight||i===$(n).scrollTop())&&(t.cancel(e),u.resolve())},33);return u.promise}function u(n,t){t[0].documentElement?t[0].documentElement.scrollTop=n.scrollHeight:t[0].body.scrollTop=n.scrollHeight}return{restrict:"A",link:function(t,i,f){function h(){o||(e.tagName==="BODY"?u(e,n):f.speed?(o=!0,r(e,f.speed).then(function(){o=!1})):$(e).scrollTop(e.scrollHeight))}var s=f.target&&$(f.target)||i,e=s[0],o=!1;t.$watch(function(){return e.offsetTop+e.scrollHeight},h)}}}]);angular.module(microsoft.support.moduleName).directive("chatConnectingProgress",["$interval","$rootScope","$filter","compassService","chatStateService","waitTimeService","flightService","clientConfig","rccService",function(n,t,i,r,u,f,e,o,s){function y(n){n.timeRemainingText=null;n.extendedWait=!1;n.config=h;n.positionInQueue=null;l=h.minutesCountdownEnabled?6e4:1e3;n.timeRemaining=h.minutesCountdownEnabled?f.getChatWaitTime():h.defaultWaitTime;v(n)}function p(n){return n&&n.metaTags!=="chat"}function w(n){return n.some(function(n){return n.metaTags.indexOf("callback")>-1})}function b(i,f){i.timeRemaining--;u.getChatEstablished()?n.cancel(f):i.timeRemaining<=0?(t.$broadcast("ChatExtendedWait"),i.timeRemaining=0,i.extendedWait=!0,i.options=(r.getMenuOptionsForId(u.getSubject())||[]).filter(p),w(i.options)&&s.init(function(){s.isWithinOperatingHours(u.getSubject(),"callback").then(function(n){i.callbackStatus=n.status})}),n.cancel(f)):h.minutesCountdownEnabled&&a(i)}function a(n){c&&(n.timeRemainingText=k(n.timeRemaining))}function v(n){var t=r.getChat();t&&t.loading&&(c={singular:t.loading.minutesProgressedSingular,plural:t.loading.minutesProgressed},a(n))}function k(n){return n&&n>1?i("compassFormat")(c.plural,{"time-remaining":n}):c.singular}function d(n){return n.timeRemaining}function g(n){return n.positionInQueue}var l,c,h={defaultWaitTime:o.ChatConfig.ChatDefaultWaitTime,minutesCountdownEnabled:e.isUserInFlight("wt")};return{restrict:"A",templateUrl:"/PartialViews/Contact/Chat/Connecting.html",scope:!0,link:function(t){var i;y(t);i=n(function(){b(t,i)},l);t.timeRemainingDisplay=function(){return d(t)};t.positionInQueueDisplay=function(){return g(t)};t.$on("CompassContentReady",function(){v(t)});t.$on("$destroy",function(){i&&n.cancel(i)});t.$on("ChatQueueStatus",function(n,i){t.positionInQueue=i.position})}}}]),function(n){n.controller("ChatController",["$scope","$rootScope","$cookies","$timeout","$log","$routeParams","$window","$location","agentChatService","chatStateService","rccService","clientConfig","languageService","chatMessageFactory","chatSenderTypes","chatMessageService","nativeAppService","compassService","qosTelemetryService","navigationService","flightService","emailTranscriptService",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){function tt(n,i,r){var u=new v(n,i,r);return t.$broadcast("ChatMessageReceived",u),u}function rt(){n.chat=b.getChat();n.status.waitingOnCompass=!n.chat}function ut(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.sendFailure}function ft(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.userDisplayName}function it(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.systemDisplayName}function et(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.agentTransferred}n.chatWizard={};n.config={MaxChatMsgChars:l.ChatConfig.ChatMaxMessageChars,timeout:l.ChatConfig.ChatDefaultTimeout,chatTypingBoxId:c.getChatTypingBoxId(),chatReconnectWaitTime:l.ChatConfig.ChatReconnectWaitTime,hoopsEnabled:l.ChatConfig.AllowHoursOfOperation,chatTranscriptEnabled:g.isUserInFlight("ct"),chatScreenShareEnabled:l.ChatConfig.AllowChatScreenShare&&w.hasCapability("ScreenSharing"),userPauseResumeEnabled:w.hasCapability("PauseSharing"),templateUrl:"/PartialViews/Contact/Chat/ChatControl.html"};n.senderTypes=y;n.isInNotificationFlight=g.isUserInFlight("chat-notifications-1");n.audioAlert=null;n.firstChatMessageRecieved=!1;n.chatWizard.resetChat=function(){var i=a.langLocale();n.isNative=w.isNative();n.displayChatScreenShare=!1;n.sharingScreen=!1;n.status={waitingOnHoops:!1,waitingOnRcc:!0,waitingOnCompass:!0};n.chatWizard.templateUrl="";n.chatWizard.agentInfo={};n.chatWizard.chatInitialized=!1;n.chatWizard.chatInputBoxText="";n.chatWizard.inputIsDisabled=!1;n.chatWizard.chatMessages=[];n.chatWizard.isAgentTyping=!1;n.chatWizard.showReconnectingMessage=!1;n.chatWizard.showClientReconnectingMessage=!1;n.chatWizard.showDisconnectMessage=!1;n.chatWizard.showCancelButton=!d.isRoot();n.chatWizard.submitDisabled=!1;n.chatWizard.sendButtonIcon=null;n.longQueue=null;n.chatWizard.survey={displayChatSurvey:!1,displayChatEnd:!1,userFeedback:null,sendTranscript:n.config.chatTranscriptEnabled,userEmail:l.authInfo.displayName?l.authInfo.displayName:"",question1:0,question2:0};t.$broadcast("ChatReset");c.init(function(){n.config.hoopsEnabled?(n.status.waitingOnRcc=!1,n.status.waitingOnHoops=!0,c.isWithinOperatingHours(h.getSubject(),"chat").then(function(t){n.status.waitingOnHoops=!1;t.isOpen?n.chatWizard.initChat():o.path("/hoops/chat/"+h.getSubject())})):n.chatWizard.initChat()});rt()};n.chatWizard.initChat=function(){t.$broadcast("ChatRequested");c.enqueueChat();n.chatWizard.templateUrl=n.config.templateUrl};n.chatWizard.cancelChat=function(){h.clearState();t.$broadcast("ChatBack")};n.chatWizard.connectionFail=function(){n.chatWizard.templateUrl="/PartialViews/Contact/Chat/ConnectionFailed.html"};n.chatWizard.chatSubmitClick=function(t){if(n.chatWizard.chatInputBoxText!==""){n.chatWizard.chatInputBoxText=n.chatWizard.chatInputBoxText.replace(/(?:\r\n|\r|\n)/g,"<br />");var i=tt(n.chatWizard.chatInputBoxText,ft(),y.User);c.sendMessage(i);n.chatWizard.chatInputBoxText="";t&&t.preventDefault()}};n.closeSurvey=function(){n.chatWizard.survey.displayChatSurvey=!1;t.$broadcast("ChatSurvey",!1)};n.submitSurvey=function(){t.$broadcast("ChatFeedback",{helped:n.chatWizard.survey.userFeedback,question1:n.chatWizard.survey.question1,question2:n.chatWizard.survey.question2});n.chatWizard.survey.sendTranscript&&nt.emailChatTranscript(h.getVisitId(),n.chatWizard.survey.userEmail,(new Date).getTimezoneOffset()).then(function(n){t.$broadcast("EmailTranscriptSuccess",n)},function(n){t.$broadcast("EmailTranscriptFailure",n)});n.closeSurvey()};n.cancelSurvey=function(){n.closeSurvey()};n.backToChat=function(){n.chatWizard.inputIsDisabled=!1;n.chatWizard.submitDisabled=!1;n.chatWizard.survey.displayChatEnd=!1};n.endChat=function(){n.chatWizard.survey.displayChatEnd=!1;n.chatWizard.survey.displayChatSurvey=!0;t.$broadcast("chatSurveyDisplayed");n.chatWizard.isAgentTyping=!1;n.chatWizard.inputIsDisabled=!0;n.chatWizard.submitDisabled=!0;tt(n.chat.chatting.answerTechDisconnect,it(),y.SystemInfo);h.clearState();c.endChat()};n.chatWizard.handleChatInterrupted=function(){n.chatWizard.submitDisabled=!0;n.chatWizard.inputIsDisabled=!0;n.chatReconnectTimer=r(function(){(n.chatWizard.showReconnectingMessage||n.chatWizard.showClientReconnectingMessage)&&(n.chatWizard.showReconnectingMessage=!1,n.chatWizard.showClientReconnectingMessage=!1,n.chatWizard.showDisconnectMessage=!0,k.createEvent(k.eventTypes.awasa.chatReconnectTimedOut).reject(),h.clearState(),c.endChat(),n.chatWizard.chatInitialized||t.$broadcast("500Error",{reason:"Disconnected in Queue"}))},n.config.chatReconnectWaitTime)};n.chatWizard.handleChatReconnected=function(){n.chatWizard.showDisconnectMessage||n.chatWizard.showReconnectingMessage||n.chatWizard.showClientReconnectingMessage||(n.chatReconnectTimer&&r.cancel(n.chatReconnectTimer),n.chatWizard.submitDisabled=!1,n.chatWizard.inputIsDisabled=!1)};n.$on("ChatScreenShareRequest",function(){n.displayChatScreenShare=!0});n.$on("ChatScreenShareDenied",function(){n.displayChatScreenShare=!1});n.$on("ChatScreenShareEstablished",function(){n.sharingScreen=!0});n.$on("ChatScreenShareClosed",function(){n.displayChatScreenShare=!1;n.sharingScreen=!1});n.$on("ChatScreenShareConnectFailed",function(){n.displayChatScreenShare=!1});n.$on("ChatSessionClosed",function(){n.displayChatScreenShare=!1;n.sharingScreen=!1});n.$on("CompassContentReady",function(){rt()});n.$on("ChatTyping",function(t,i){n.chatWizard.isAgentTyping=i});n.$on("ChatError",function(t,i){i.nextStep==="callback"?o.path("/contact/callback/"+h.getSubject()+"/"):i.nextStep==="fail"&&n.chatWizard.connectionFail(t,i)});n.$on("ChatMessageSendError",function(){tt(ut(),it(),y.SystemError)});n.$on("EnqueueChatFailure",function(){t.$broadcast("500Error",{reason:"Failed to enqueue chat"})});n.$on("EnqueueChatSuccess",function(){n.longQueue=r(function(){t.$broadcast("ChatLongQueue")},l.ChatConfig.ChatLongQueue)});n.$on("DisplayCallback",function(){n.chatWizard.scheduleCallback()});n.$on("ChatSessionEstablished",function(t,i){s.lookupAgent(i.agentId);h.setChatEstablished(!0);n.chatWizard.chatInitialized=h.getChatEstablished()});n.$on("AgentDataReady",function(t,i){r.cancel(n.longQueue);i&&i!=="null"&&(h.setAgent(i),n.chatWizard.agentInfo=i)});n.$on("ChatMessageReceived",function(i,r){if(p.appendMessage(r),n.chatWizard.chatMessages=p.getAllMessages(),n.firstChatMessageRecieved==!1){if(t.$broadcast("ShowToast",r.chatMessage),n.isInNotificationFlight&&("Notification"in e?Notification.permission==="granted"||e.document.hasFocus()?Notification.permission==="granted"&&t.$broadcast("Html5Notification","HasPermission"):(t.$broadcast("Html5Notification","NotificationPermissionRequested"),Notification.requestPermission(function(n){n==="denied"?t.$broadcast("Html5Notification","NotificationPermissionDenied"):n==="default"?t.$broadcast("Html5Notification","NotificationPermissionDismissed"):t.$broadcast("Html5Notification","NotificationPermissionGranted")})):t.$broadcast("Html5Notification","NotSupported"),!e.document.hasFocus()&&"Notification"in e&&Notification.permission==="granted"))var u=new Notification(r.chatMessage);n.firstChatMessageRecieved=!0}e.document.hasFocus()||(!n.audioAlert&&n.chat&&n.chat.audioAlertLink&&(n.audioAlert=new Audio(n.chat.audioAlertLink)),n.audioAlert&&!!(n.audioAlert.canPlayType&&n.audioAlert.canPlayType("audio/mpeg;"))&&n.audioAlert.play())});n.$on("ChatSessionClosed",function(){n.endChat()});n.$on("ChatTransferred",function(n,t){t.agentId&&(s.lookupAgent(t.agentId),tt(et(),it(),y.SystemInfo))});n.$on("$destroy",function(){h.getChatEstablished()&&c.endChat();h.clearState();r.cancel(n.longQueue)});n.$on("AgentDisconnected",function(t,i){!i.agentId||n.chatWizard.showClientReconnectingMessage||n.chatWizard.showReconnectingMessage||(n.chatWizard.showReconnectingMessage=!0,n.chatWizard.handleChatInterrupted())});n.$on("AgentReconnected",function(t,i){i.agentId&&n.chatWizard.showReconnectingMessage&&(n.chatWizard.showReconnectingMessage=!1,n.chatWizard.handleChatReconnected())});n.$on("ChatChannelDisconnected",function(){n.chatWizard.showReconnectingMessage||n.chatWizard.showClientReconnectingMessage||(n.chatWizard.showClientReconnectingMessage=!0,n.chatWizard.handleChatInterrupted())});n.$on("ChatChannelReconnected",function(){n.chatWizard.showClientReconnectingMessage&&(n.chatWizard.showClientReconnectingMessage=!1,n.chatWizard.handleChatReconnected())});n.$on("MessageWindowTryAgain",function(){n.chatWizard.cancelChat()});n.$on("ChatPageTimeout",function(){n.isReady||t.$broadcast("500Error",{reason:"Timeout occurred on a chat page",data:n.status})});n.$watch("chatWizard.chatInputBoxText",function(){n.chatWizard.submitDisabled=n.chatWizard.chatInputBoxText===""?!0:!1});n.$watchCollection("status",function(t){var i=!1;t&&(i=!0,Object.keys(t).map(function(n){i=i&&!t[n]}));n.isReady=i});n.chatWizard.resetChat()}])}(angular.module(microsoft.support.moduleName)),function(n){n.value("chatSenderTypes",{User:0,Agent:1,SystemInfo:2,SystemError:3});n.factory("chatMessageFactory",[function(){function n(n,t,i){return{chatMessage:n,chatTimeStamp:(new Date).getTime(),chatSender:i,fromDisplayText:t}}return n}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("chatMessageService",["$log",function(){var n=[];this.appendMessage=function(t){n.push(t)};this.getAllMessages=function(){return n};this.messageCount=function(){return n.length};this.clearMessages=function(){n=[]}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("ChatScreenShareController",["$scope","$rootScope","nativeAppService","chatSenderTypes","chatMessageFactory","contactCommands","compassService",function(n,t,i,r,u,f,e){function o(n,i,r){var f=new u(n,i,r);t.$broadcast("ChatMessageReceived",f)}function a(){return n&&n.chat&&n.chat.error&&n.chat.error.genericError}function v(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.screenEnd}function y(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.annotationStart}function p(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.annotationStop}function w(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.screenError}function s(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.systemDisplayName}function b(){return n&&n.chat&&n.chat.chatting&&n.chat.chatting.screenShareDeny}function l(){n.chat=e.getChat()}var h=0,c={Reserved:0,Annotation:1,View:2,Interactive:3};n.config={maxRetry:3,userPauseResumeEnabled:i.hasCapability("PauseSharing")};n.reset=function(){n.displayChatScreenShare=!1;n.sharingScreen=!1;n.screenSharePaused=!1;n.waitingForResponse=!1;n.currentMode=null;n.requestedMode=null;n.reconnecting=!1;n.agentCommands={beginsharing:null};h=0;l()};n.grantScreenShare=function(){n.agentCommands.beginsharing&&(t.$broadcast("ChatScreenShareAccept"),i.sendAppCommand(n.agentCommands.beginsharing),n.waitingForResponse=!0)};n.denyScreenShare=function(){n.displayChatScreenShare=!1;n.agentCommands.beginsharing=null;o(b(),s(),r.SystemInfo);t.$broadcast("ChatScreenShareDenied");i.sendAgentRequestResponse(f.beginSharing,!1,"The user denied the request for remote assistance","")};n.toggleScreenShare=function(){var t;t=n.screenSharePaused?f.resumeSharingByUser:f.pauseSharingByUser;i.sendAgentUserRequest(t);n.waitingForResponse=!0};n.$on("CompassContentReady",l);n.$on("ChatScreenShareRequest",function(t,i){n.agentCommands.beginsharing=i;n.displayChatScreenShare=!0});n.$on("ChatScreenShareReconnect",function(){n.sharingScreen&&(n.screenSharePaused?t.$broadcast("ChatScreenShareClosed"):(n.reconnecting=!0,n.waitingForResponse=!0))});n.$on("ChatScreenShareEstablished",function(){n.reconnecting||(n.sharingScreen=!0,n.currentMode=c.Interactive);n.waitingForResponse=!1;n.reconnecting=!1;n.agentCommands.beginsharing=null});n.$on("ChatScreenShareClosed",function(){n.sharingScreen&&o(v(),s(),r.SystemInfo);n.reset()});n.$on("SetSharingModeRequest",function(t,i){i!==n.currentMode&&(n.requestedMode=i)});n.$on("SetSharingMode",function(){n.requestedMode&&(n.currentMode===c.Annotation&&o(p(),s(),r.SystemInfo),n.currentMode=n.requestedMode,n.requestedMode=null,n.currentMode===c.Annotation&&o(y(),s(),r.SystemInfo))});n.$on("ToggleScreenShare",function(t,i){n.screenSharePaused=i;n.waitingForResponse=!1});n.$on("ChatScreenShareConnectFailed",function(){h>=n.config.maxRetry?(o(a(),s(),r.SystemError),n.reset(),i.sendAgentUserRequest(f.sharingSessionFailed)):(h++,n.grantScreenShare())});n.$on("ChatScreenShareError",function(){o(w(),s(),r.SystemError);n.waitingForResponse=!1});n.$on("ChatSessionClosed",function(){n.reset()});n.reset()}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("chatscreenshare",[function(){return{restrict:"A",templateUrl:"/PartialViews/Contact/Chat/ScreenShare.html",controller:"ChatScreenShareController"}}]),function(n){n.service("chatStateService",["$rootScope","$log","$routeParams","clientConfig","localStorageService",function(n,t,i,r,u){function h(){f=JSON.parse(JSON.stringify(s.defaultState));e()}function e(){u.commitWithoutExpiration(s.chatStateKey,f)}function o(){var n=u.getCacheContent(s.chatStateKey);return n?(f=n,!0):!1}var f,s={chatStateKey:"ChatState",defaultState:{visitId:null,token:null,agent:null,subject:null,validationKey:null,chatEstablished:!1,appStartContext:null,enqueueId:null,chatId:null,parentCv:null,guestResponses:null}};this.reset=function(){o()?(f.chatEstablished=!1,f.visitId=null,f.enqueueId=null,f.chatId=null,e()):h()};this.setParentCv=function(n){f.parentCv=n;e()};this.getParentCv=function(){return o(),f.parentCv};this.setVisitId=function(n){f.visitId=n;e()};this.getVisitId=function(){return o(),f.visitId};this.setEnqueueId=function(n){f.enqueueId=n;e()};this.getEnqueueId=function(){return o(),f.enqueueId};this.setChatId=function(n){f.chatId=n;e()};this.getChatId=function(){return o(),f.chatId};this.setToken=function(n){f.token=n;e()};this.getToken=function(){return o(),f.token};this.setAgent=function(n){f.agent=n;e()};this.getAgent=function(){return o(),f.agent};this.setSubject=function(n){f.subject=n;e()};this.getSubject=function(){var n=i.subject;return n?n:(o(),f.subject)};this.setValidationKey=function(n){f.validationKey=n;e()};this.getValidationKey=function(){return o(),f.validationKey};this.setChatEstablished=function(n){f.chatEstablished=n;e()};this.getChatEstablished=function(){return o(),f.chatEstablished};this.setAppStartContext=function(n){f.appStartContext=n;e()};this.getAppStartContext=function(){return o(),f.appStartContext};this.setGuestResponses=function(n){f.guestResponses=n;e()};this.getGuestResponses=function(){return o(),f.guestResponses};this.clearState=function(){var n=f.visitId;h();f.visitId=n;e()};this.isReconnectValid=function(){return!1};this.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("chatTokenService",["$http",function(n){var t={baseUrl:"/api/Token"};this.getTokenForUser=function(i){return i?n.get(t.baseUrl+"/GetRatToken/"):n.get(t.baseUrl+"/GetToken/")};this.getEncryptedValue=function(i,r,u){var f={params:{sessionId:i,phoneNumber:r,guestResponses:u}};return n.get(t.baseUrl+"/GetUserState/",f)}}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("imageFallback",[function(){return{restrict:"A",link:function(n,t,i){t.bind("error",function(){t.attr("src")!==i.imageFallback&&t.attr("src",i.imageFallback)})}}}]);angular.module(microsoft.support.moduleName).directive("messageWindow",["compassService","chatSenderTypes",function(n,t){function u(){return i&&i.chatting&&i.chatting.reconnectingMessage}function f(){return i&&i.chatting&&i.chatting.reconnectingClientMessage}function e(){return i&&i.error&&i.error.tryAgainButton}function o(){return i&&i.error&&i.error.chatDisconnected}function r(r){i=n.getChat();r.senderTypes=t;r.reconnectingAgent=u();r.reconnectingClient=f();r.tryAgain=e();r.disconnected=o()}var i;return{restrict:"A",templateUrl:"/PartialViews/Contact/Chat/MessageWindow.html",scope:{messages:"=",isClientReconnecting:"=",isAgentReconnecting:"=",isDisconnected:"="},replace:!0,link:function(n){n.retry=function(){n.$emit("MessageWindowTryAgain")};n.isMessageType=function(n,t){return n&&n.chatSender===t};n.$on("CompassContentReady",function(){r(n)});r(n)}}}]);angular.module(microsoft.support.moduleName).directive("agentHeader",["compassService",function(n){function r(){return t&&t.chatting&&t.chatting.agentDefaultImage.url}function u(){return t&&t.chatting&&t.chatting.agentImageAlt}function f(){return t&&t.chatting&&t.chatting.answerTech}function e(){return t&&t.chatting&&t.chatting.agentDisplayName}function i(i){i.agentInfo&&i.agentInfo!=="null"||(i.agentInfo={});t=n.getChat();i.agentImageAltText=u();i.answerTechText=f()}var t;return{restrict:"A",templateUrl:"/PartialViews/Contact/Chat/AgentHeader.html",scope:{agentInfo:"="},replace:!0,link:function(n){n.$on("CompassContentReady",function(){i(n)});i(n);n.$watchCollection("agentInfo",function(t){t&&(n.agentInfo.DisplayName=t.DisplayName||e(),n.agentInfo.ImageUrl=t.ImageUrl||r())})}}}]),function(n){n.value("channelStatuses",{OPEN:0,CLOSED:1,UNAVAILABLE:2});n.service("channelReaderService",["$log","$filter","channelStatuses",function(n,t,i){function u(n){var t=n.split(" ")[0].split(":"),i=new Date,r=parseInt(t[0],10),u=parseInt(t[1],10),f=parseInt(t[2],10);return i.setHours(r,u,f),i}function f(n){var t=n.getHours(),i=n.getMinutes(),f=n.getTimezoneOffset(),r=parseInt(f/60,10),u=f-r*60;return i-u<0?(t--,i=(60+i-u)%60):i-u>=60?(t++,i=(i-u)%60):i-=u,n.setMinutes(i),t-r<0?(t=(24+t-r)%24,n.setDate(n.getDate()-1)):t-r>23?(t=(t-r)%24,n.setDate(n.getDate()+1)):t-=r,n.setHours(t),n}function e(){var i=[],n=new Date,t;for(n.setDate(n.getDate()-n.getDay()),t=0;t<7;t++)i.push(new Date(n)),n.setDate(n.getDate()+1);return i}function o(n,t){var i=n.getMonth(),r=t.getMonth();return i===r?n.getDate()<t.getDate()?-1:n.getDate()>t.getDate()?1:0:i<r?-1:1}function s(n){var s=[],o;if(n&&n.length===7){var a=e(),i,r="",u="",f=[];for(o=1;o<8;o++){var l=o%7,h=n[l],c=t("date")(a[l],"EEE");i?i.join(", ")==h.join(", ")?u=c:(f=u==""?[r]:[r,u],s.push({days:f,shifts:i}),r=c,u="",i=h):(r=c,i=h)}f=u==""?[r]:[r,u];s.push({days:f,shifts:i})}return s}var r={};this.setHOOPsStatusEnum=function(n){r=n};this.getChannelOperation=function(t,i){var f,u,r;if(t&&Array.isArray(t)||(t=t?[t]:[]),i!==""&&(i=i.toLowerCase(),t=t.filter(function(n){return n.Type&&(n.Type=n.Type.toLowerCase()),n&&n.Type===i})),t.length==0)return n.error("No channels found for channelType: "+i),{isOpen:!0,isAvailable:!1,status:this.getStatus(!0,!1),schedule:[]};for(f=t.length,u=0;u<f;u++)if(r=this.getOperationStatus(t[u]),r.isOpen&&r.isAvailable)break;return{e2eSchedule:r.e2eSchedule,isOpen:r.isOpen,isAvailable:r.isAvailable,status:r.status,schedule:s(r.schedule)}};this.getStatus=function(n,t){if(n){if(n&&!t)return i.UNAVAILABLE}else return i.CLOSED;return i.OPEN};this.getOperationStatus=function(i){var e,s,w,y,k,d;if(typeof i=="undefined"||typeof i.IsAvailable=="undefined"||typeof i.HOOPsStatus=="undefined")return n.error("malformatted status"),{isAvailable:!0,isOpen:!0,status:this.getStatus(!0,!0),schedule:[]};var c=i.HOOPsStatus!=r.OutOfHOOPs,l=i.IsAvailable,h=[],p=!1;if(!c||!l){for(e=0;e<7;e++)h[e]=[];for(e=0;e<7;e++){if(s=i.HoopsSchedule[e],s&&!Array.isArray(s))return n.error("malformatted channel schedule"),{isAvailable:l,isOpen:c,status:this.getStatus(c,l),schedule:[]};if(s&&s.length>0){p=!0;for(w in s){var b=s[w],a=u(b.StartTime),v=u(b.EndTime);a=f(a);v=f(v);y=t("date")(a,"shortTime")+"-"+t("date")(v,"shortTime");k=o(a,v);k<0?(d=e-1<0?6:e-1,h[d].push(y)):h[e].push(y)}}}}return h=p?h:[],{e2eSchedule:i.HoopsSchedule,isAvailable:l,isOpen:c,status:this.getStatus(c,l),schedule:h}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("ContactDisplayController",["$scope","$rootScope","$window","$location","nativeAppService","navigationService","compassService","chatStateService","languageService",function(n,t,i,r,u,f,e,o){function s(){n.isNative=u.isNative()}function h(){n.contactHeader=e.getContactHeader();n.msLogo=e.getMicrosoftLogo();n.msLogoAlt=e.getMicrosoftLogoAlt();n.comingSoon=e.getComingSoon()}function c(){return r.search()&&typeof r.search().disableassistedsupport!="undefined"&&r.search().disableassistedsupport==="true"}n.config={disableAssistedSupport:c()};n.reset=function(){h();s()};n.navInterruptCondition=function(){return!u.isNative()&&o.getChatEstablished()};n.navInterruptedMessage=function(){return e.getNavigationInterrupted()};n.$on("$locationChangeStart",function(){n.isCompassContentLoading=!0});n.$on("CompassContentReady",h);n.$on("NativeCookieUpdate",s);n.$on("$viewContentLoaded",function(){f.update()});n.$on("NativeSignInFailed",function(){f.isRoot()?t.$broadcast("500Error"):i.history.back()});n.$on("ChatBack",function(){f.isRoot()||(i.document.referrer.indexOf("live.com")>=0?f.goToRoot():i.history.back())});n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("ContactFrameController",["$scope","$rootScope","$route","navigationService","compassService","languageService",function(n,t,i,r,u,f){function e(){n.contactHeader=u.getContactHeader();n.backText=u.getBackText();n.icon=u.getContactSupportIcon()}n.reset=function(){n.chatSource="/"+f.langLocale()+"/contact/menu/";n.showBackButton=!0;n.isRTL=f.currentDirection()==="rtl";e()};n.backClick=function(){t.$broadcast("ChatBack")};n.$on("CompassContentReady",e);n.$on("ChatSessionEstablished",function(){n.showBackButton=!1});n.$on("ChatSessionClosed",function(){n.showBackButton=!0});n.$on("$routeChangeSuccess",function(){var t=i.current.data.isLandingPage,u=r.isRoot();n.showBackButton=!1;t||u||(n.showBackButton=!0);n.showIcon=!1;(t||u)&&(n.showIcon=!0)});n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("emailTranscriptService",["$http","$q",function(n,t){var i={baseUrl:"/api/emailTranscript"},r=function(i,r){var u=t.defer();return n.get(i,r).then(function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise};this.emailChatTranscript=function(n,t,u){var f={params:{visitId:n,email:t,timeOffset:u}};return r(i.baseUrl,f)}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("HoopsController",["$rootScope","$scope","$location","compassService","chatStateService","rccService","clientConfig",function(n,t,i,r,u,f,e){function h(){var n=i.path().split("/");return n.length>=3?n[2]:""}function c(n){return o(n,"hoops")}function l(n){return o(n,"chat")}function a(n){return o(n,"callback")}function o(n,t){return n&&n.metaTags.indexOf(t)>-1}function v(){t.options=t.options||[];t.options=t.options.filter(c);t.options=t.options.filter(l);t.options=t.options.filter(a)}function s(){t.hoursOfOperation=r.getHoursOfOperation();t.options=r.getMenuOptionsForId(u.getSubject());t.status.waitingOnCompass=!t.hoursOfOperation&&!t.options;v()}t.config={timeout:e.ChatConfig.ChatDefaultTimeout};t.reset=function(){t.status={waitingOnRcc:!0,waitingOnCompass:!0,waitingOnHoops:!0};f.initLazy(function(){t.status.waitingOnRcc=!1;f.isWithinOperatingHours(u.getSubject(),h()).then(function(n){t.status.waitingOnHoops=!1;t.hoopsSchedule=n.schedule})});s()};t.$on("CompassContentReady",s);t.$on("HoopsMenuPageTimeout",function(){t.isReady||n.$broadcast("500Error",{reason:"Timeout occurred on a hours of operation page",data:t.status})});t.$watchCollection("status",function(n){var i=!1;n&&(i=!0,Object.keys(n).map(function(t){i=i&&!n[t]}));t.isReady=i});t.reset()}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("menuExtras",["$rootScope","$document","$location","$window",function(n,t,i,r){function u(n){n.wasButtonClicked=!1;n.wasElemClicked=!1;n.isMenuShown=!1}function f(n){n.wasButtonClicked||n.wasElemClicked||!n.isMenuShown||(n.isMenuShown=!1);n.wasButtonClicked=!1;n.wasElemClicked=!1}function e(n){n.wasButtonClicked||(n.wasElemClicked=!0)}return{restrict:"A",templateUrl:"/PartialViews/SupportMenu/MenuExtras.html",scope:{extras:"=",icon:"="},link:function(o,s){var h=function(){e(o);o.$apply()},c=function(){f(o);o.$apply()};o.menuExtraClick=function(t){t.externalLink?r.open(t.link.linkUrl):i.path(t.link.linkUrl);n.$broadcast("MenuExtraClicked",t)};o.toggleMenu=function(){o.isMenuShown=!o.isMenuShown;o.wasButtonClicked=!0};t.bind("click",c);s.bind("click",h);o.$on("$destroy",function(){t.unbind("click",c);s.unbind("click",h)});u(o)}}}]);angular.module(microsoft.support.moduleName).directive("menuOptions",["$log","$rootScope","$filter","$location","$window","waitTimeService","chatStateService","compassService","channelStatuses",function(n,t,i,r,u,f,e,o,s){function w(){return r.path().indexOf("/hoops/")===0}function b(n,t,i){if(n&&n.link&&n.metaTags.indexOf(t)>-1){var r=o.getHoursOfOperation();i===s.CLOSED?(v.description=r?r.currentlyClosed:"",n=y(n,v),n=k(n,t),n=a(n)):i===s.UNAVAILABLE&&(l.description=r?r.outage:"",l.link.linkUrl=r?r.globalSupport:"",n=y(n,l))}return n}function y(n,t){var i={};return i.link={linkUrl:t&&t.link&&t.link.linkUrl||n.link.linkUrl,linkText:t&&t.link&&t.link.linkText||n.link.linkText},i.icon=t.icon||n.icon,i.description=t.description||n.description,i.metaTags=t.metaTags||n.metaTags,i.externalLink=typeof t.externalLink!="undefined"?t.externalLink:n.externalLink,i.clickableLink=typeof t.clickableLink!="undefined"?t.clickableLink:n.clickableLink,i}function k(n,t){return n&&n.link&&n.link.linkUrl&&(n.link.linkUrl=i("compassFormat")(n.link.linkUrl,{"channel-type":t})),n}function a(n){return n&&n.link&&n.link.linkUrl&&(n.link.linkUrl=i("compassFormat")(n.link.linkUrl,{"subject-id":e.getSubject()})),n}function d(i,f){if(!i||!i.link||!i.link.linkUrl){n.error("Invalid Link: ",i);return}i.clickableLink&&(f.hasModality&&(i=a(i)),i.externalLink?u.open(i.link.linkUrl):w()?r.path(i.link.linkUrl).search("fromHoops","true"):r.path(i.link.linkUrl),t.$broadcast("MenuLinkClicked",i))}function c(n){n.waitTimeText={chat:f.getChatWaitTimeText(),callback:f.getCallbackWaitTimeText()}}function p(n,t,i){return t===h.callbackType||t===h.chatType?(n||[]).map(function(n){return b(n,t,i)}):n}var h={callbackType:"callback",chatType:"chat",hoopsUrl:"/hoops/{channel-type}/{subject-id}/"},v={link:{linkUrl:h.hoopsUrl},metaTags:h.hoopsType},l={externalLink:!0,link:{linkUrl:""}};return{restrict:"A",templateUrl:"/PartialViews/SupportMenu/MenuOptions.html",scope:{options:"=",hasModality:"=",chatStatus:"=",callbackStatus:"="},link:function(n){n.followLink=function(t){d(t,n)};n.getLinkId=function(n){return n=a(n),n.link.linkUrl};n.$watch("options",function(t){n.displayOptions=n.hasModality?angular.copy(t)||[]:t||[]});n.$watch("chatStatus",function(t){typeof t!="undefined"&&t!==s.OPEN&&(n.displayOptions=p(n.displayOptions,h.chatType,t))});n.$watch("callbackStatus",function(t){typeof t!="undefined"&&t!==s.OPEN&&(n.displayOptions=p(n.displayOptions,h.callbackType,t))});n.$watch("hasModality",function(t){t&&c(n)});n.$on("ChatExtendedWait",function(){c(n)});n.$on("ChatInitComplete",function(){c(n)});n.$on("ChatEstimateWaitTimeUpdate",function(){c(n)});n.$on("ChatQueueStatus",function(){c(n)})}}}]),function(n){n.service("navigationService",["$rootScope","$window","$location","$log",function(n,t,i,r){var u=t&&t.sessionStorage;try{t.sessionStorage.setItem("sessionStorageTest","");t.sessionStorage.removeItem("sessionStorageTest","")}catch(f){u=!1}u||r.error("Local storage not supported");this.update=function(){if(u){var n=t.sessionStorage.getItem("contactapphistory");n||(basePage=t.location.pathname,t.sessionStorage.setItem("contactapphistory",basePage))}};this.isRoot=function(){if(this.update(),u){var n=t.sessionStorage.getItem("contactapphistory");return n?n===t.location.pathname:!1}return!1};this.goToRoot=function(){if(u){var n=t.sessionStorage.getItem("contactapphistory");n&&(t.location.pathname=n)}}}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("passcode",["$rootScope","passcodeService","clientConfig",function(n,t,i){function u(n){n.code="";n.hasError=!1;n.hasValidPasscode=!1;n.waitingForResponse=!1;n.passcodeSuccess=n.passcodeSuccess||null;n.passcodeFailure=n.passcodeFailure||null}var r={passcodeLength:i.PasscodeConfig.PasscodeLength};return{restrict:"A",templateUrl:"/PartialViews/Passcode/Passcode.html",scope:{view:"=",passcodeSuccess:"@",passcodeFailure:"@"},link:function(i){i.sendCode=function(r){i.waitingForResponse=!0;t.getRatRequest(r).then(function(t){i.waitingForResponse=!1;t&&(i.hasValidPasscode=!0,i.passcodeSuccess&&n.$broadcast(i.passcodeSuccess,t))},function(t){i.waitingForResponse=!1;t.status===404?(i.hasError=!0,i.passcodeFailure&&n.$broadcast(i.passcodeFailure,r)):n.$broadcast("500Error",{reason:"Azure table down or multiple request objects made for same passcode"})})};i.isValid=function(n){return!isNaN(n)&&n.length>0&&n.length<=r.passcodeLength};i.resetError=function(){i.hasError=!1};u(i)}}}]),function(n){n.service("passcodeService",["$http",function(n){this.getRatRequest=function(t){var i={params:{passcode:t}};return n.get("/api/passcode/RatRequest/",i).then(function(n){return n.data})}}])}(angular.module(microsoft.support.moduleName));awasaServicesSettings=awasaServicesSettings||{},function(n){n.service("rccService",["$log","$cookies","$interval","$q","$timeout","$rootScope","$routeParams","$location","clientConfig","languageService","channelReaderService","chatTokenService","chatMessageService","chatStateService","chatMessageFactory","chatSenderTypes","qosTelemetryService","nativeAppService","correlationVectorService","flightService","authenticationHelperService",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){function ni(n){ht.push(n);f.$broadcast("ChatInitStart");l.getTokenForUser(it).then(function(n){ut?ft&&!ot&&(awasaServicesSettings.session=!0,awasaServicesSettings.token=n.data,v.setToken(n.data),ot=!0,nt.load(v.getToken())):(ut=!0,awasaServicesSettings.developerKey=it?s.ChatConfig.RatPartnerId:s.ChatConfig.PartnerId,awasaServicesSettings.language=h.lang(),awasaServicesSettings.country=h.locale(),awasaServicesSettings.session=!0,awasaServicesSettings.messaging=!0,awasaServicesSettings.token=n.data,awasaServicesSettings.callback=pt,awasaServicesSettings.chatTypingBoxId=et.chatTypingBoxId,awasaServicesSettings.reset=!0,v.setToken(n.data),ot=!0,v.isReconnectValid()&&(awasaServicesSettings.reconnectChat=!0,awasaServicesSettings.restoreId=v.getVisitId()),e.visitId&&(awasaServicesSettings.restoreId=e.visitId,awasaServicesSettings.reconnect=!1),ct());ti();yt=w.createEvent(w.eventTypes.awasa.initialize);a.clearMessages()},function(n){n.status===401&&f.$broadcast("ProcessUserSignIn",!0)})}function ct(){lt=!1;var t=w.createEvent(w.eventTypes.awasa.download);$.getScript("https://"+s.ChatConfig.ChannelSdkServerPath,function(){n.log("Adding new channel-services-sdk");t.resolve()}).fail(function(n,i,r){t.reject(r)})}function pt(t,i){var s,o,r,e;switch(i.type){case"exception":s=w.createEvent(w.eventTypes.awasa.error);n.error("Exception received: Sender: "+JSON.stringify(t),i);vt.indexOf(i.errorCode)===-1&&s.reject(i);break;case"FacadeReady":nt=nt?nt:i.instance;c.setHOOPsStatusEnum(nt.HOOPsStatus);u(function(){st.forEach(function(n){n()});st=[];ft=!0;f.$broadcast("ChatInitComplete")});break;case"loaded":if(n.log("Loaded callback received"),nt=i.instance,yt.resolve(),o=nt.getVisitId(),f.$broadcast("awasaVisitId",o),v.setVisitId(o),c.setHOOPsStatusEnum(nt.HOOPsStatus),nt.subscribe(nt.events.AgentTyping,tt.AgentTyping),nt.subscribe(nt.events.ChatMessageReceived,tt.ChatMessageReceived),nt.subscribe(nt.events.ChatQueueStatus,tt.ChatQueueStatus),nt.subscribe(nt.events.ChatQueued,tt.ChatQueued),nt.subscribe(nt.events.ChatRejected,tt.ChatRejected),nt.subscribe(nt.events.ChatSessionClosed,tt.ChatSessionClosed),nt.subscribe(nt.events.ChatSessionEstablished,tt.ChatSessionEstablished),nt.subscribe(nt.events.ChatSessionReconnected,tt.ChatSessionReconnected),nt.subscribe(nt.events.ChatTimeout,tt.ChatTimeout),nt.subscribe(nt.events.ChatTransferred,tt.ChatTransferred),nt.subscribe(nt.events.CommandMessageReceived,tt.CommandMessageReceived),nt.subscribe(nt.events.EstimatedWaitTime,tt.EstimatedWaitTime),nt.subscribe(nt.events.SessionRestored,tt.SessionRestored),nt.subscribe(nt.events.TransferSessionEstablished,tt.TransferSessionEstablished),nt.subscribe(nt.events.Validation,tt.Validation),nt.subscribe(nt.events.ChatChannelDisconnected,tt.ChatChannelDisconnected),nt.subscribe(nt.events.ChatChannelReconnected,tt.ChatChannelReconnected),nt.subscribe(nt.events.AgentDisconnected,tt.AgentDisconnected),nt.subscribe(nt.events.AgentReconnected,tt.AgentReconnected),i&&i.restored)for(r=0;r<i.attributes.length;r++)i.attributes[r].name=="AgentId"&&(e=v.getAgent(),e||(e={}),e.AgentId=i.attributes[r].value,v.setAgent(e));u(function(){v.getToken()&&(nt.setToken(v.getToken()),ht.forEach(function(n){n()}),ht=[],ft=!0,f.$broadcast("ChatInitComplete"))})}}function wt(){rt&&i.cancel(rt)}function ti(){wt();rt=i(function(){ii()},et.tokenRefreshInterval)}function ii(){var t=function(t){v.setToken(t);typeof nt=="undefined"?rt&&i.cancel(rt):(n.log("User token refreshed"),nt.setToken(v.getToken()))};l.getTokenForUser(it).then(function(n){t(n.data)})}function bt(t){var r=w.createEvent(w.eventTypes.awasa.chat),i;k.extendCv();i=nt.enqueue("chat",v.getSubject(),t,function(n){var t=gt.getEstimatedChatWaitTime();n.visitId=v.getVisitId();n.waitTimeEstimate=t?t.AverageWaitTime:0;n.enqueueId=i;r.resolve(n);f.$broadcast("EnqueueChatSuccess",n)},function(t){t.visitId=v.getVisitId();r.reject(t);n.error("Chat failed to enqueue",t);f.$broadcast("EnqueueChatFailure",t)});f.$broadcast("awasaEnqueueId",i);v.setEnqueueId(i)}function ri(n,t){for(var i in n)if(n[i].Id==t)return n[i].Name;return null}function kt(n,t,i){var u,r;for(u in n)if(n[u].Id==i)return r=n[u].Channels.filter(function(n){return n.Type==t})[0],r&&(r.AverageWaitTime=r.AverageWaitTime*1),r;return null}function at(n){if(nt&&typeof nt.disengageChat=="function"){var t=w.createEvent(w.eventTypes.awasa.disengage);nt.disengageChat(function(i){return f.$broadcast("NotifyAppClosingComplete"),i.visitId=v.getVisitId(),f.$broadcast("ChatDisengageSuccess",i),t.resolve(i),n&&ct(),!0},function(i){return f.$broadcast("NotifyAppClosingComplete"),i.visitId=v.getVisitId(),f.$broadcast("ChatDisengageFailure",i),t.reject(i),n&&ct(),!0})}else f.$broadcast("NotifyAppClosingComplete");return!1}var nt,rt,ut=!1,ft=!1,lt=!1,st=[],ht=[],et={tokenRefreshInterval:18e4,chatTypingBoxId:"chat-client-message-input-textbox"},vt=["CHAT_MESSAGE_ERROR","CHANNEL_CONTACTSCHEDULED"],dt=["CHANNEL_CONTACTINVALID","CHANNEL_APPTUNAVAILABLE"],yt,gt=this,it=!1,ot=!1,tt={AgentTyping:function(n){f.$apply(function(){f.$broadcast("AgentTyping",n.isTyping)})},ChatMessageReceived:function(t){f.$apply(function(){n.log("Chat Message Received"+JSON.stringify(t));var i=new y(t.msg,v.getAgent().DisplayName,p.Agent);f.$broadcast("ChatMessageReceived",i);f.$broadcast("AgentTyping",!1)})},ChatQueueStatus:function(t){f.$apply(function(){n.log("Chat Queue Status"+JSON.stringify(t));f.$broadcast("ChatQueueStatus",t)})},ChatQueued:function(t){n.log("Chat Queued"+JSON.stringify(t))},ChatRejected:function(t){n.log("Chat Rejected"+JSON.stringify(t))},ChatSessionClosed:function(t){f.$apply(function(){n.log("Chat Session Closed"+JSON.stringify(t));f.$broadcast("ChatSessionClosed",{})})},ChatSessionEstablished:function(t){f.$apply(function(){n.log("Chat Session Established"+JSON.stringify(t));f.$broadcast("awasaChatId",t.chatId);v.setChatId(t.chatId);f.$broadcast("ChatSessionEstablished",{agentId:t.agentId})})},ChatSessionReconnected:function(t){f.$apply(function(){n.log("Chat Session Reconnected"+JSON.stringify(t));f.$broadcast("ChatSessionRestored",t)})},ChatTimeout:function(t){n.log("Chat Timeout"+JSON.stringify(t))},ChatTransferred:function(t){f.$apply(function(){n.log("Chat Transferred"+JSON.stringify(t));f.$broadcast("awasaChatId",t.chatId);v.setChatId(t.chatId);k.extendCv();f.$broadcast("ChatTransferred",t)})},CommandMessageReceived:function(t){f.$apply(function(){n.log("Command Message Received"+JSON.stringify(t));f.$broadcast("CommandMessageReceived",t)})},EstimatedWaitTime:function(t){f.$apply(function(){n.log("Estimated Wait Time"+JSON.stringify(t));f.$broadcast("ChatEstimateWaitTimeUpdate",t)})},SessionRestored:function(t){n.log("Session Restored"+JSON.stringify(t))},TransferSessionEstablished:function(t){n.log("Transfer Session Established"+JSON.stringify(t))},Validation:function(t){n.log("Validation"+JSON.stringify(t))},AgentReconnected:function(t){f.$apply(function(){w.createEvent(w.eventTypes.awasa.agentReconnect).resolve();n.log("Agent Connection Restored"+JSON.stringify(t));f.$broadcast("AgentReconnected",{agentId:t.agentId})})},AgentDisconnected:function(t){f.$apply(function(){w.createEvent(w.eventTypes.awasa.agentDisconnect).reject();n.log("Agent Connection Disconnected"+JSON.stringify(t));f.$broadcast("AgentDisconnected",{agentId:t.agentId})})},ChatChannelReconnected:function(){f.$apply(function(){w.createEvent(w.eventTypes.awasa.channelReconnect).resolve();n.log("Customer Connection Restored");f.$broadcast("ChatChannelReconnected")})},ChatChannelDisconnected:function(){f.$apply(function(){w.createEvent(w.eventTypes.awasa.channelDisconnect).reject();n.log("Customer Connection Disconnected");f.$broadcast("ChatChannelDisconnected")})}};this.toggleRatMode=function(){it=!it};this.isRatMode=function(){return it};this.init=function(n){if(ut&&ot){ft?(a.clearMessages(),n()):ht.push(n);return}g.mobileSignIn(function(){ni(n)})};this.initLazy=function(n){d.isUserInFlight("delayauth-1")?ot?this.init(n):(st.push(n),ut?ft?n():st.push(n):(awasaServicesSettings.lazyLoad=!0,awasaServicesSettings.developerKey=it?s.ChatConfig.RatPartnerId:s.ChatConfig.PartnerId,awasaServicesSettings.language=h.lang(),awasaServicesSettings.country=h.locale(),awasaServicesSettings.messaging=!0,awasaServicesSettings.callback=pt,awasaServicesSettings.chatTypingBoxId=et.chatTypingBoxId,awasaServicesSettings.reset=!0,ut=!0,ct())):this.init(n)};this.getChatTypingBoxId=function(){return et.chatTypingBoxId};this.enqueueChat=function(t){var i,r;if(v.getChatEstablished()){f.$broadcast("DoubleChatEnqueued");n.error("Chat already exists. Can't enqueue again.",t);return}t=t||{};t.attributes=t.attributes||[];t.mode=t.mode||(typeof e.mode!="undefined"?e.mode:s.ChatConfig.Mode);v.getAppStartContext()&&t.attributes.push({name:"AppStartContext",value:JSON.stringify(v.getAppStartContext()),encrypted:!1});i="";try{i=parent&&parent.window&&parent.window.location&&parent.window.location.href}catch(u){}t.attributes.push({name:"WebStartContext",value:JSON.stringify({url:window&&window.location&&window.location.href,parentUrl:i,userAgent:navigator&&navigator.userAgent}),encrypted:!1});it?bt(t):(r=v.getGuestResponses(),l.getEncryptedValue(v.getVisitId(),null,r?r:null).then(function(n){s&&s.authInfo&&s.authInfo.puid&&(t.attributes.push({name:"WindowsLiveUserPUID",value:n.data[0].Value,encrypted:!0}),t.attributes.push({name:"IsAuthenticated",value:n.data[1].Value,encrypted:!0}));e.rejoin==="true"&&(t.rejoin=!0,t.agentId=v.getAgent().AgentId);s.ChatConfig&&s.ChatConfig.ExplicitAgentId&&s.ChatConfig.ExplicitAgentId>0&&(t.agentId=s.ChatConfig.ExplicitAgentId);var i="/"+h.langLocale()+"/contact"+o.path()+"?visitId="+v.getVisitId()+"&rejoin=true&forceorigin=osg";i=b.isNative()?"ms-contact-support://rejoin"+i+"&isNative=true":"https://"+o.host()+i;t.attributes.push({name:"rejoinurl",value:i,encrypted:!1});n.data[2]&&n.data[2].Key==="prechatsurvey"&&t.attributes.push({name:"prechatsurvey",value:n.data[2].Value,encrypted:!0});bt(t)}))};this.getChatTypingBoxId=function(){return et.chatTypingBoxId};this.getCallbackTime=function(t,i,r){var e={test:s&&s.ChatConfig&&s.ChatConfig.UseTestCallbackQueue,count:i},u=w.createEvent(w.eventTypes.awasa.times);nt.getCallbackTime(r,t,e,function(n){n.visitId=v.getVisitId();u.resolve(n);f.$broadcast("GetCallbackTimeSuccess",n)},function(t){t.visitId=v.getVisitId();u.reject(t);n.error("failure: "+t);f.$broadcast("GetCallbackTimeFailure",t)})};this.enqueueCallback=function(t,i,r,u){var e=this.validateNumber(t,r);f.$broadcast("CallbackPhoneValidation",e);e&&e.isValid&&l.getEncryptedValue(v.getVisitId(),e.formattedContact).then(function(t){var o={test:s&&s.ChatConfig&&s.ChatConfig.UseTestCallbackQueue,attributes:[{name:"WindowsLiveUserPUID",value:t.data[0].Value,encrypted:!0},{name:"IsAuthenticated",value:t.data[1].Value,encrypted:!0},{name:"CallbackNumber",value:t.data[2].Value,encrypted:!0},]},e,h;u&&(o.timeslot=u);e=w.createEvent(w.eventTypes.awasa.callback);k.extendCv();h=nt.enqueue("callback",i,o,function(n){n.visitId=v.getVisitId();n.locale=r;e.resolve(n);f.$broadcast("EnqueueCallbackSuccess",n)},function(t){t&&t.errorCode&&(vt.indexOf(t.errorCode)!=-1||(dt.indexOf(t.errorCode)!=-1?(t.status="400",e.reject(t)):e.reject(t)));n.error("Callback failed to enqueue"+JSON.stringify(t));t.locale=r;f.$broadcast("EnqueueCallbackFailure",t)});v.setEnqueueId(h)})};this.validateNumber=function(n,t){return nt?nt.validate("callback",n,{country:t}):null};this.sendMessage=function(t){var r,i;lt?t.chatMessage=="agentend"?f.$broadcast("ChatSessionClosed",{}):(r=new y("Echo: "+t.chatMessage,"Emulator Agent",p.Agent),v.setAgent(),f.$broadcast("ChatMessageReceived",r)):(i=w.createEvent(w.eventTypes.awasa.sendMessage),nt.sendChat(t.chatMessage,function(n){n.visitId=v.getVisitId();i.resolve();f.$broadcast("ChatMessageSendSuccess",n)},function(t){t.visitId=v.getVisitId();i.reject(t);n.error("Failed to send message"+JSON.stringify(t));f.$broadcast("ChatMessageSendError",t)}))};this.getEstimatedCallbackWaitTime=function(n){var t=nt.getEstimatedWaitTime();return n||(n=v.getSubject()),kt(t,"Callback",n)};this.getEstimatedChatWaitTime=function(n){var t=nt.getEstimatedWaitTime();return n||(n=v.getSubject()),kt(t,"Chat",n)};this.getSubjectName=function(n){var t=nt.getEstimatedWaitTime();return n||(n=v.getSubject()),ri(t,n)};this.isWithinOperatingHours=function(n,i){var f=w.createEvent(w.eventTypes.awasa.channelStatus),o={mode:typeof e.mode!="undefined"?e.mode:s.ChatConfig.Mode},u;return typeof e.scheduleAsOf!="undefined"&&(o.scheduleAsOf=e.scheduleAsOf),u=r.defer(),typeof e.hoops!="undefined"&&e.hoops.toLowerCase()!=="true"||t&&typeof t.hoops!="undefined"&&JSON.parse(t.hoops)?u.resolve({isOpen:!0,isAvailable:!0,status:c.getStatus(!0,!0),schedule:[]}):(i=i?i:"",n?nt.getChannelStatus(n,o,function(t){var r=c.getChannelOperation(t,i.toLowerCase());r.isOpen&&!r.isAvailable?f.reject({description:"subject id "+n+" for "+i+" channel is unavailable"}):f.resolve();u.resolve(r)},function(n){f.reject(n);u.resolve({isOpen:!1,isAvailable:!1,status:c.getStatus(!1,!1),schedule:[]})}):(f.reject({description:"subject id is blank",status:400}),u.resolve({isOpen:!1,isAvailable:!1,status:c.getStatus(!1,!1),schedule:[]}))),u.promise};this.endChat=function(n){return at(n)};f.$on("ChatSessionClosed",function(){wt()});f.$on("NativeAppClosing",function(){at()});f.$on("ForwardToAgent",function(n,t){var i=w.createEvent(w.eventTypes.awasa.sendCommand);nt.sendCommand(t,function(n){i.resolve();f.$broadcast("ForwardToAgentSuccess",n)},function(n){i.reject(n);f.$broadcast("ForwardToAgentFailure",n)})});s&&s.TestConfig&&s.TestConfig.AllowChatEmulator&&f.$on("ChatEmulate",function(){lt=!0;at(!1);f.$broadcast("ChatSessionEstablished",{agentId:123456789})})}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("SupportMenuController",["$scope","$rootScope","$location","$filter","$window","$route","$routeParams","compassService","clientConfig","chatStateService","rccService","authenticationHelperService","osService","nativeAppService","flightService",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){function b(n){var t=null;n&&n.hasModality&&(t=n.subjectId);h.setSubject(t)}function p(n,t){return n.links.some(function(n){return n.metaTags.indexOf(t)>-1})}function k(){return{manufacturerName:e[n.config.manufacturerKey]||"",deviceModel:e[n.config.deviceModelKey]||"",manufacturerLink:decodeURIComponent(e[n.config.manufacturerSupportKey]||""),mobileOperatorLink:decodeURIComponent(e[n.config.mobileOperatorSupportKey]||""),mobileOperator:e[n.config.mobileOperatorKey]||""}}function d(n,t){n&&n.links&&t&&(n.header=r("compassFormat")(n.header,t),n.links=n.links.map(function(n){return n.metaTags.indexOf("device-custom")>-1&&(n=g(n,t),n.description=r("compassFormat")(n.description,t),n.link.linkText=r("compassFormat")(n.link.linkText,t),n.link.linkUrl=r("compassFormat")(n.link.linkUrl,t)),n}))}function g(t,i){return n.isNative?n.isMobile?tt(t,i):nt(t,i):(t.link.linkText="",t)}function nt(n,t){var i=n.metaTags||"",r=i.indexOf("ms-device")>-1,u=i.indexOf("anon-oem")>-1;return r?t.manufacturerName!=="Microsoft Corporation"&&(n.link.linkText=""):(u&&t.manufacturerName&&(n.link.linkText=""),u||r||t.manufacturerName||(n.link.linkText=""),t.manufacturerLink||(n.link.linkText="")),t.deviceModel||(n.link.linkText=n.link.linkText.replace(/\(.+?\)/,"")),n}function tt(n,t){var i=n.metaTags||"",r=t&&t.manufacturerName==="Microsoft Corporation",u=i.indexOf("ms-device")>-1,f=i.indexOf("operator")>-1,e=i.indexOf("manufacturer")>-1;return f&&(t.mobileOperator&&t.mobileOperatorLink||(n.link.linkText="")),u&&(r&&t.deviceModel||(n.link.linkText="")),e&&!u&&(t.deviceModel&&t.manufacturerName&&t.manufacturerLink&&!r||(n.link.linkText="")),f||e||u||(t.mobileOperator&&t.mobileOperatorLink||t.deviceModel&&t.manufacturerName&&t.manufacturerLink||r)&&(n.link.linkText=""),n}function w(){var t=o.getMenu(i.path().substring(1)),r=o.getServiceAgreement(),u=o.getMenuExtras();t&&(n.menuWizard.page=t,n.status&&(n.status.waitingOnCompass=!1),b(t),d(t,n.oem),t.hasModality&&n.initMenu());u&&(n.menuWizard.menuExtras=u);r&&(n.menuWizard.serviceAgreement=r.serviceAgreement,n.menuWizard.serviceAgreementLink=r.serviceAgreementLink)}n.config={callbackTag:"callback",chatTag:"chat",manufacturerKey:"manufacturer",deviceModelKey:"devicemodel",manufacturerSupportKey:"manufacturersupportlink",mobileOperatorSupportKey:"mobileoperatorsupportlink",mobileOperatorKey:"mobileoperator",timeout:s.ChatConfig.ChatDefaultTimeout,inRatPhoneFlight:y.isUserInFlight("rp")};n.e2eSchedule={};n.menuWizard={};n.menuWizard.reset=function(){n.status={waitingOnRcc:!1,waitingOnCompass:!0,waitingOnChatHoops:!1,waitingOnCallbackHoops:!1};n.isLandingPage=f.current.data.isLandingPage;n.isMobile=a.isMobile();n.isNative=v.isNative();n.oem=k();w()};n.initMenu=function(){n.status.waitingOnRcc=!0;c.initLazy(function(){n.status.waitingOnRcc=!1;p(n.menuWizard.page,n.config.chatTag)&&(n.status.waitingOnChatHoops=!0,c.isWithinOperatingHours(h.getSubject(),n.config.chatTag).then(function(t){n.status.waitingOnChatHoops=!1;n.chatStatus=t.status;n.e2eSchedule.chat=t.e2eSchedule}));p(n.menuWizard.page,n.config.callbackTag)&&(n.status.waitingOnCallbackHoops=!0,c.isWithinOperatingHours(h.getSubject(),n.config.callbackTag).then(function(t){n.status.waitingOnCallbackHoops=!1;n.callbackStatus=t.status;n.e2eSchedule.callback=t.e2eSchedule}))})};n.openServiceAgreement=function(){n.menuWizard.serviceAgreementLink&&n.menuWizard.serviceAgreementLink.linkUrl&&u.open(n.menuWizard.serviceAgreementLink.linkUrl)};n.$on("CompassContentReady",w);n.$on("SupportMenuPageTimeout",function(){n.isReady||t.$broadcast("500Error",{reason:"Timeout occurred on a support menu page",data:n.status})});n.$watchCollection("status",function(t){var i=!1;t&&(i=!0,Object.keys(t).map(function(n){i=i&&!t[n]}));n.isReady=i});y.isUserInFlight("delayauth-1")?n.menuWizard.reset():l.mobileSignIn(n.menuWizard.reset)}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).service("waitTimeService",["$filter","$rootScope","rccService","compassService",function(n,t,i,r){function s(n){var t;o?(t=n==="chat"?i.getEstimatedChatWaitTime():i.getEstimatedCallbackWaitTime(),f[n]=t?Math.ceil(Math.max(t.AverageWaitTime/60,1)):1):i.initLazy(function(){o=!0;s(n)})}function h(n){u&&(s(n),e[n]=l(f[n]))}function l(t){return t&&t>1?n("compassFormat")(u.plural,{"wait-time":t}):u.singular}function c(){var n=r.getChat();n&&n.error&&(u={singular:n.error.currentWaitTimeSingular,plural:n.error.currentWaitTime})}var u,f,e,o;this.reset=function(){f={chat:1,callback:1};e={chat:null,callback:null};u=null;o=!1;c()};this.getChatWaitTime=function(){return s("chat"),f.chat};this.getCallbackWaitTime=function(){return s("callback"),f.callback};this.getChatWaitTimeText=function(){return h("chat"),e.chat};this.getCallbackWaitTimeText=function(){return h("callback"),e.callback};t.$on("ChatInitComplete",function(){o=!0});t.$on("CompassContentReady",c);this.reset()}]),function(n){n.controller("UnauthFormController",["$scope","$rootScope","$location","$routeParams","chatStateService","compassService","clientConfig",function(n,t,r,u,f,e,o){function s(){var t=e.getUnauthForm();t&&(n.form=t[u.name],n.isReady=!0)}n.config={timeout:o.ChatConfig.ChatDefaultTimeout};n.reset=function(){n.responses=[];s()};n.submit=function(){var t=h(n.responses);f.setGuestResponses(JSON.stringify(t));r.path("/chat/"+u.id+"/")};var h=function(t){var r=[];for(i=0;i<t.length;i++)r.push({name:n.form.questions[i].questionText.text,value:t[i]});return r};n.reset();n.$on("CompassContentReady",s)}])}(angular.module(microsoft.support.moduleName));app.directive("asset",["$compile","$location","assetService",function(n,t,i){return{restrict:"A",transclude:!0,scope:{asset:"="},link:function(t,r,u){t.data={details:null};t.$watch("data.details",function(){if(t.data&&t.data.details){switch(t.data.details.assetType){case"video":var i=600,f=500;if(u.props){t.props=JSON.parse(u.props);switch(t.props.size){case"half":i=Math.floor(i/2);f=Math.floor(f/2);break;case"quarter":i=Math.floor(i/4);f=Math.floor(f/4)}}t.content='<iframe src="'+t.data.url+'" width="'+i+'" height="'+f+'" frameborder="0" allowfullscreen="true"><\/iframe>';break;case"product":t.content="<span>"+t.data.details.title+"<\/span>"}r.html(t.content);n(r.contents())(t)}});i.getAsset(t.asset).then(function(n){t.data=n.data},function(){r.html("Asset not found")})}}}]);app.service("assetService",["$location","contentApiService",function(n,t){var i={};this.getAsset=function(r){if(i&&i[r])return i[r];var u=t.getAsset(r,n.search());return u.then(function(){i[r]=u}),u}}]);angular.module(microsoft.support.moduleName).filter("compassFormat",["languageService",function(n){return function(t,i){var r=t,u;if(r=r&&r.replace(/{lang-locale}/g,n.langLocale()),!r||!angular.isObject(i))return r;for(u in i)while(r.indexOf("{"+u+"}")>=0)(i[u]===null||i[u]===undefined)&&(r=r.replace("{"+u+"}","")),r=r.replace("{"+u+"}",i[u]);return r}}]),function(n){n.service("compassService",["$log","$rootScope","$cookieStore","contentApiService","currentLanguageService","clientConfig","localStorageService",function(n,t,i,r,u,f,e){function o(n,t){return t&&s&&s[n]&&s[n][t]?s[n][t]:!t&&s&&s[n]?s[n]:null}function c(n){var i=r.getCompassContentForPage(n);i.then(function(n){if(n&&n.data){for(var i in n.data)s[i]=n.data[i];e.commit(l(),s);t.$broadcast("CompassContentReady")}else t.$broadcast("500Error",{reason:"Failed to load compass content",response:n})},function(){})}function l(){return h.compassContentKey}var s={},h={compassContentKey:"CompassContent",contentNodes:[{condition:"",key:"search",url:""},{condition:"menu",key:"menus",url:"menu/"},{condition:"chat",key:"chat",url:"menu/"},{condition:"callback",key:"callback",url:"menu/"},{condition:"schedulecallback",key:"callback",url:"menu/"},{condition:"form",key:"form",url:"menu/"},{condition:"allproducts",key:"allProducts",url:"allproducts/"},{condition:"products",key:"productHubPage",url:"productPages/"},{condition:"search",key:"searchResults",url:"searchresults/"},{condition:"enterprise",key:"menus",url:"menu/"},{condition:"partner",key:"menus",url:"menu/"},{condition:"rat-phone",key:"menus",url:"menu/"}]};this.getContentNodes=function(){return h.contentNodes};this.clearCache=function(){s={};e.invalidateCache()};this.fetchContent=function(r){var o,l,e,f;for(i.get("useCompassPreview")&&(n.info("Preview mode: cache wiped for new fetch"),this.clearCache()),o=u.getLang(),pathParts=r.split("/"),o&&pathParts[0].toUpperCase()===o.toUpperCase()&&pathParts.shift(),l=pathParts[0],e=0;e<h.contentNodes.length;e++)if(f=h.contentNodes[e],f&&l===f.condition){s&&s[f.key]?(n.info("Cache hit for node",f),t.$broadcast("CompassContentReady")):c(f.url);break}s&&s.search||c("")};this.getContent=function(n){return o(n)};this.getPageInfo=function(){return o("basePage")};this.getMenu=function(n){return o("menus",n)};this.getMenuExtras=function(){var n=o("menuExtras");return n&&n.menuExtras?{icon:n.menuExtraIcon,extras:n.menuExtras.links}:null};this.getMenuOptionsForId=function(n){var r=parseInt(n,10),t=this.getMenu(),i;if(t)for(i in t)if(t[i].subjectId==r)return t[i].links;return null};this.getChat=function(){return o("chat")};this.getChatSurvey=function(){return o("chat","survey")};this.getCallback=function(){return o("callback")};this.getSupportedLocales=function(){return o("callback","supportedLocales")};this.getUnauthForm=function(){return o("form")};this.getServiceAgreement=function(){var n=o("serviceAgreement"),t=o("serviceAgreementLink");return n&&t?{serviceAgreement:n,serviceAgreementLink:t}:null};this.getComingSoon=function(){return o("comingSoon")};this.getContactHeader=function(){return o("contactHeader")};this.getHoursOfOperation=function(){return o("hoursOfOperation")};this.getContactSupportIcon=function(){return o("contactSupportIcon")};this.getPasscode=function(){return o("passcode")};this.getMicrosoftLogo=function(){return o("microsoftLogo")};this.getMicrosoftLogoAlt=function(){return o("microsoftLogoAlt")};this.getNavigationInterrupted=function(){return o("navigationInterrupted")};this.getSearchView=function(){return o("search")};this.getSearchResultsView=function(){return o("searchResults")};this.getProductView=function(){return o("products")};this.getLinkFarm=function(){return o("linkFarm")};this.getBackText=function(){return o("basePage","contactSupportBack")};this.getCloseText=function(){return o("basePage","contactSupportClose")};this.getLanguageSelectorTitle=function(){return o("basePage","languageSelectorTitle")};this.getLanguages=function(){return o("basePage","languages")};this.getFeedbackCtrl=function(){return o("basePage","feedback")};this.getF1Footer=function(){return o("basePage","f1Footer")};this.getSelfhostFeedback=function(){return o("basePage","selfHostFeedbackView")};this.getOfflineMessage=function(){return o("basePage","offlineMessage")};this.getAllProducts=function(){return o("allProducts")};this.getProductPage=function(){return o("productHubPage")};this.getContentSurvey=function(){return o("contentSurvey")};s=f.SiteContentConfig&&f.SiteContentConfig.ClientCompassCachingEnabled&&f.SiteContentConfig.ClientCompassCacheTimeout?e.getCacheContent(l())||{}:{}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("contentApiService",["$rootScope","$log","$http","clientConfig","$q",function(n,t,i,r,u){var e="/api/content/",f=function(n,t){var o=e+n,r=u.defer(),f={iecbust:(new Date).getTime()};return t!=null&&(f=angular.extend(f,t)),i.get(o,{cache:!1,params:f}).then(function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise};this.getAgentById=function(n){return f("GetAgent/"+n)};this.getCompassContentForPage=function(n){return f("GetCompassContentForPage/"+n)};this.getKbArticle=function(n,t){var i=u.defer(),e="kb/"+n,r=null;return t!=null&&t.kbPreview!=null&&t.kbPreview==="true"&&(r={kbPreview:!0}),f(e,r).then(function(n){var t={kbArticle:n.data,noIndex:n.headers("x-kb-noindex")};i.resolve(t)},function(n){i.reject(n)}),i.promise};this.getGwtArticle=function(n,t){return option=null,t&&t.preview&&(option={preview:!0}),f("Gwt/"+n,option)};this.getAsset=function(n,t){return option=null,t&&t.preview&&(option={preview:!0}),f("Asset/"+n,option)};this.getOneSiteResources=function(){return r&&r.SiteContentConfig&&r.SiteContentConfig.OneSiteEnabled?f("OneSite"):null};this.getDevices=function(){return f("devices/")}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("flightService",["$cookies",function(n){var t={flightCookie:"smc_f"};this.isUserInFlight=function(i){return n&&typeof n[t.flightCookie]=="string"&&typeof i=="string"?n[t.flightCookie].toLowerCase().indexOf(i.toLowerCase())>=0:!1}}])}(angular.module(microsoft.support.moduleName));app.directive("gwtAction",[function(){return{require:"^gwt",restrict:"A",templateUrl:"/PartialViews/Gwt/Action.html",transclude:!0,scope:{paneId:"=",actionId:"=",actions:"="},link:function(n,t,i,r){for(var u=0;u<n.actions.length;u++)n.actionId==n.actions[u].id&&(n.action=n.actions[u]);n.appendPane=function(t){r.appendPane(n.paneId,t)}}}}]),function(n){n.controller("GwtController",["$scope","$location","$routeParams","gwtService",function(n,t,i,r){n.reset=function(){i.articleId!=null&&r.getGwtArticle(i.articleId,t.search()).then(function(t){n.article=t.data})};n.reset()}])}(angular.module(microsoft.support.moduleName));app.directive("gwt",["$compile","$anchorScroll","$location",function(){return{restrict:"A",templateUrl:"/PartialViews/Gwt/Container.html",scope:{article:"="},link:function(n){n.article&&n.article.panes&&(n.paneList=[n.article.panes[0]])},controller:["$scope",function(n){this.appendPane=function(t,i){for(var u,r=0;r<n.article.panes.length;r++)if(i==n.article.panes[r].id){for(u=0;u<n.paneList.length;u++)if(t==n.paneList[u].id){n.paneList=n.paneList.slice(0,u+1);break}n.paneList.push(n.article.panes[r])}};n.$watch(function(){return n.article&&n.article.panes&&n.article.panes[0]},function(t,i){t!==i&&(n.paneList=[n.article.panes[0]])})}]}}]);app.service("gwtService",["contentApiService",function(n){this.getGwtArticle=function(t,i){return n.getGwtArticle(t,i)}}]),function(n){n.directive("comscore",["clientConfig",function(n){return{restrict:"A",link:function(t,i){n&&n.ComScore&&n.ComScore.ComScoreEnabled&&i.append($("<script>",{Src:n.ComScore.SurveySource,Async:"",Type:"text/javascript"}))}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("LinkFarmController",["$rootScope","$scope","compassService",function(n,t,i){function r(){var n=i.getLinkFarm();n&&(t.view=n)}t.reset=function(){r()};t.reset();t.$on("CompassContentReady",function(){r()})}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("metatags",["$window","$rootScope","$interval","$cookies","nativeAppService","chatStateService",function(n,t,i,r,u){function s(n,t){e(n)||$("head").append($('<meta name="'+n+'" content="" />'));f(n,t)}function f(n,t){$('meta[name="'+n+'"]').attr("content",t)}function e(n){return $('meta[name="'+n+'"]').attr("name")}function o(n){return $('meta[name="'+n+'"]').attr("content")}return{restrict:"A",link:function(t){t.$on("$locationChangeSuccess",function(s,h,c){var a=o("ms.refView"),l;(f("ms.refView",c),f("ms.pageType",h),e("ms.isNative")&&f("ms.isNative",(!!u.isNative()).toString()),e("ms.partnerId")&&f("ms.partnerId",r.smcpartner||""),e("ms.flightId")&&f("ms.flightId",r.smc_f||""),e("ms.cV")&&n&&n.Asimov&&n.Asimov.cv&&f("ms.cV",n.Asimov.cv.getValue()||""),e("ms.muid")&&f("ms.muid",r.MUID||""),a!="")&&(e("ms.auth")?o("ms.auth")?t.$emit("metaTagsUpdated"):l=i(function(){o("ms.auth")&&(t.$emit("metaTagsUpdated"),i.cancel(l))},250,20):t.$emit("metaTagsUpdated"))});t.$on("UserSignedIn",function(){f("ms.auth","1")});t.$on("UserSignedOut",function(){f("ms.auth","0")});t.$on("UpdateMetaTag",function(n,t){s(t.name,t.value)});t.$on("RemoveMetaTag",function(n,t){f(t.name,"")});t.$on("awasaChatId",function(n,t){f("ms.chatId",t.toString())});t.$on("awasaVisitId",function(n,t){f("ms.visitId",t.toString())});t.$on("awasaEnqueueId",function(n,t){f("ms.enqueueId",t.toString())})}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("currentLanguageService",["$document","$log","clientConfig","locationService",function(n,t,i){this.setLang=function(n){var i,t;return(i=n==null?location.pathname.substring(1):n.locale,t=h(i),t!=null?r("SMCsiteLang",t):r("SMCsiteLang",n.locale),e(n.direction),t!=null)?t:n.locale};this.getLang=function(){return u("SMCsiteLang")||"en-US"};this.getDirection=function(){return u("SMCsiteDir")||"ltr"};this.setDirection=function(n){return e(n)};this.getFallbackLocaleReverseLookup=function(n){var t=o();for(var i in t)if(t[i].Fallback==n)return t[i].Locale;return null};var s="."+window.location.host,f="; Domain="+s+";expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/",r=function(i,r){n[0].cookie=i+"="+r+f;t.info("Set Cookie to:"+i+"="+r+f)},u=function(t){return!t||!n[0]?null:decodeURIComponent(n[0].cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},e=function(n){var t=u("SMCsiteDir");return(r("SMCsiteDir",n),n!=t)?!0:!1},h=function(n){var t=o();for(var i in t)if(t[i].Locale==n)return t[i].Fallback;return null},o=function(){if(i&&i.SupportedLocalesConfig&&i.SupportedLocalesConfig.LanguageFallbacks)return i.SupportedLocalesConfig.LanguageFallbacks}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("LanguageController",["$window","$rootScope","$scope","$location","$document","languageService","clientConfig","compassService",function(n,t,r,u,f,e,o,s){var a=e.langLocale();r.displayLanguageSelector=!1;var h=function(){r.languages=e.languages();r.currentLanguage=e.currentLanguage();r.currentTextDirection=e.currentDirection();r.languageSelectorTitle=s.getLanguageSelectorTitle();r.languagesListForLargeScreens=l()},c=function(){t.$digest();n.scrollTo(0,f[0].body.scrollHeight)},l=function(){var n=[],t=[];for($.each(r.languages,function(t,i){n.push(i)}),n=n.sort(function(n,t){return n.displayName<=t.displayName?-1:n.displayName>t.displayName?1:0}),i=0;i<=Math.floor(n.length/4);i++)t[i*4]=n[i];for(i=Math.floor(n.length/4)+1,j=0;i<=Math.floor(n.length/2);i++,j++)t[j*4+1]=n[i];for(i=Math.floor(n.length/2)+1,j=0;i<=Math.floor(n.length*(3/4));i++,j++)t[j*4+2]=n[i];for(i=Math.floor(n.length*(3/4))+1,j=0;i<=n.length;i++,j++)t[j*4+3]=n[i];return t};r.setLanguage=function(n){e.set(n)};r.closeClick=function(){r.displayLanguageSelector=!1;c()};r.$on("languageSelectorClicked",function(){o&&o.SiteContentConfig&&o.SiteContentConfig.LanguageSelectorEnabled&&(r.displayLanguageSelector=r.displayLanguageSelector?!1:!0,c())});r.$on("CompassContentReady",function(){h()});h()}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("languageService",["$rootScope","$routeParams","currentLanguageService","compassService","locationService",function(n,t,i,r,u){var f={},o="displayName",e="";this.set=function(n){var t=i.getLang().toLowerCase(),r=i.setLang(n),f;t!=r&&(u.getCurrentPath().indexOf(t)==-1&&(t=i.getFallbackLocaleReverseLookup(t)),f=u.getCurrentPath().replace(t.toLowerCase(),r).toLowerCase(),u.setPathAndReload(f))};this.langLocale=function(){return i.getLang().toLowerCase()};this.currentDirection=function(){return i.getDirection().toLowerCase()};this.currentLanguage=function(){var n=this.langLocale().toLowerCase();if(f[n])return f[n][o]};this.lang=function(){var t=this.langLocale(),n=t.split("-");return n.length>1&&n.pop(),n.join("-")};this.locale=function(){var t=this.langLocale(),n=t.split("-");return n[n.length-1]};this.languages=function(){if(!f[0]){var n=r.getLanguages();n!=null&&(f=n)}return f};this.languageSelectorTitle=function(){return e||(e=r.getLanguageSelectorTitle()),e};t.langLocale&&this.set(t.langLocale)}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("textDirection",["currentLanguageService",function(n){return{restrict:"A",compile:function(t){var i=n.getDirection();t.removeAttr("text-direction");t.attr("dir",i);i==="rtl"&&t.addClass("css-rtl")}}}]),function(n){n.controller("AllProductsController",["$scope","$window","compassService","languageService",function(n,t,i){function r(){var t=i.getAllProducts();t&&(n.allProducts=t,n.allProducts.productCategories=n.allProducts.productCategories.filter(function(n){return n.links=n.links.filter(function(n){return n.linkUrl!==""&&n.linkUrl!=="tbd"&&n.linkText!==""}),n.links.length>0}))}n.reset=function(){r();n.showColumns=[]};n.showMore=function(t){n.showColumns[t]=!0};n.showLess=function(t){n.showColumns[t]=!1};n.display=function(t,i,r){return r<t.collapseCount||n.showColumns[i]?!0:!1};n.isExternal=function(n){return t&&t.location&&t.location.origin&&typeof n=="string"&&!(n.indexOf(t.location.origin)>0||n.indexOf("://")==-1)};n.$on("CompassContentReady",function(){r()});n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("ProductHubController",["$rootScope","$scope","$routeParams","clientConfig","compassService","contentApiService",function(n,t,i,r,u,f){var o={FriendlyName:"Test Name",Manufacturer:"Test Manufacturer",OSEdition:"Test OS",OEMSerialNumber:"Test OEM Serial Number",Warranty:"Test Warranty"},e,s,l="Windows Phone",h=function(){var n=u.getProductPage();n&&(t.view=n,t.productTitle=u.getContent("productTitle"),t.versionselected=t.view[0],c());i.mock&&t.versionselected&&(t.versionselected.FriendlyName=o.FriendlyName,t.versionselected.Manufacturer=o.Manufacturer,t.versionselected.OSEdition=o.OSEdition,t.versionselected.OEMSerialNumber=o.OEMSerialNumber,t.versionselected.Warranty=o.Warranty)},a=function(){var f,n,i,r,u;if(e&&!(e.length<=0)){for(f=!1,n=0;n<e.length;n++)if(i=e[n],i.FormFactor==="Phone"){for(r=0;r<t.view.length;r++)if(u=i.OSVersion.substring(0,t.view[r].versionNumber.length)===t.view[r].versionNumber,u===!0)break;u===!0?(i.FriendlyName===l?(e[n].version=i.Manufacturer+" "+i.Model,t.versionselected=t.view[n]):(e[n].FriendlyName=i.FriendlyName,e[n].version=i.FriendlyName),e[n].sectionList=t.view[r].sectionList,e[n].versionNumber=t.view[r].versionNumber,i.Warranty||(t.view[n].Warranty="Warranty: "+i.Warranty)):(e.splice(n,1),n--)}else e.splice(n,1),n--;t.view=e;t.versionselected=t.view[0]}},c=function(){s||r.DevicesUIConfiguration.DevicesEnabled&&r.authInfo.isLoggedIn()&&f.getDevices().then(function(n){n!=null&&(s=!0,e=n.data,a())},function(){})};t.$on("CompassContentReady",function(){h()});t.reset=function(){s=!1;h()};t.$on("UserSignedIn",function(){c()});t.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("ProductListController",["$scope","clientConfig","compassService","contentApiService",function(n,t,r,u){var e,o,s=function(){o||t.authInfo.isLoggedIn()&&u.getDevices().then(function(n){n!=null&&(o=!0,e=n.data,c())},function(){})},c=function(){for(i=0;i<e.length;i++){var n=e[i];n.FormFactor==="Phone"?f("17947",n):n.FormFactor==="Tablet"?f("17688",n):n.FormFactor==="PC"||n.FormFactor==="Laptop"?f("509",n):n.FormFactor==="Console"&&f("7230",n)}},h=function(){var t=r.getProductView();t&&(n.view=t,s())},f=function(t,i){var r=l(t);r[0]&&n.view.products.unshift({name:i.FriendlyName,model:i.Model,url:r[1],isUserDevice:!0,image:{url:i.IconSource},ecoId:t})},l=function(t){var i,r;if(n.view&&n.view.products)for(j=0;j<n.view.products.length;j++)if(i=n.view.products[j].ecoId.split(","),$.inArray(t,i)>-1&&!n.view.products[j].isUserDevice)return r=n.view.products[j].url,n.view.products.splice(j,1),[!0,r];return!1};n.reset=function(){o=!1;h()};n.reset();n.$on("CompassContentReady",function(){h()});n.$on("UserSignedIn",function(){s()})}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("autoSuggest",["autoSuggestFactory","$timeout","$document",function(n,t,i){return{restrict:"A",templateUrl:"/PartialViews/Search/BingAutoSuggest.html",link:function(r,u,f){function l(t){s=t;var i=n.getSuggestions(t);i.then(function(n){r.result=n})}function p(){r.isVisible=!1;c||r.$digest();c=!1}function w(){r.isVisible=!0;r.$digest()}function a(n,t){var i=r.result.suggestions.indexOf(r.selected),u=Math.abs(t-n)/(t-n);r.selected=i===-1?r.result.suggestions[n]:i===t?"":r.result.suggestions[i+u];y()}function b(n){if(n.which===40)return a(0,r.result.suggestions.length-1),r.$digest(),!1;if(n.which===38)return a(r.result.suggestions.length-1,0),r.$digest(),!1;n.which===13&&(r.result&&(r.result.suggestions=[]),r.$digest())}function v(n){angular.equals(i[0].activeElement,e[0])&&(n===r.selected||n===s||h||(h=!0,l(n),t(function(){h=!1;v(r[o])},300)))}function y(){r[o]=r.selected!==""?r.selected:s}var e=$(f.inputSource),o=f.inputModel,s="",h=!1,c=!1;r.isVisible=!1;r.generateSuggestionHTML=function(n){var t=s.toLowerCase();return t.length?(t+=t==="b"?" ":"",n="<b>"+n.toLowerCase()+"<\/b>",n.replace(t,"<\/b>"+t+"<b>")):n};r.isSelected=function(n){return n===r.selected};r.searchSuggestion=function(n){r.selected=n;y();r.primarySearchClicked()};r.$on("SearchPrimaryClicked",function(){c=!0;i[0].activeElement.blur()});r.$watch(o,v);e.keydown(b);e.focus(w);e.blur(p);l("")}}}]),function(n){n.factory("autoSuggestFactory",["$injector","clientConfig",function(n,t){var i=t.AutosuggestConfig;return i&&i.Utility&&i.Utility==="DGPS"?n.get("dgpsAutoSuggestService"):n.get("bingAutoSuggestService")}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("bingAutoSuggestService",["$http","$rootScope","clientConfig","languageService",function(n,t,i,r){var u=i.AutosuggestConfig;this.getSuggestions=function(t){if(t===""||!u.Enabled)return null;var r=e(t),i={};return n.get(r).then(function(n){f(n.data)||o(i,n.data)}),i};var f=function(n){return!n||!n.AS||!n.AS.Results?(t.$broadcast("AutoSuggestBadResults",n),!0):!1},e=function(n){var t=u.ServiceUri,i=u.AppId;return t.replace("{0}",i).replace("{1}",n).replace("{2}",r.langLocale())},o=function(n,t){var i=t.AS.Results.filter(function(n){return n.Type==="AS"})[0].Suggests;n.suggestions=i.map(function(n){return n.Txt})}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("dgpsAutoSuggestService",["$http","$q","$filter","$log","clientConfig","languageService","osService","qosTelemetryService",function(n,t,i,r,u,f,e,o){function s(n){return!n||n==="null"?!0:n.AutoSuggestions?!1:!0}function h(n){var t=u.AutosuggestConfig.ServiceUri;return t=t.replace("{0}",encodeURIComponent(n)),t=t.replace("{1}",f.langLocale()),t.replace("{2}",e.getOS())}function c(n){var r=n.AutoSuggestions.map(function(n){return n.CompletionText}),t=[];return r.forEach(function(n){t.indexOf(n)===-1&&t.push(n)}),i("limitTo")(t,10)}this.getSuggestions=function(i){var f=t.defer(),a=e.isCorsEnabled(),l;return!u.AutosuggestConfig.Enabled||!a?f.promise:(l=h(i),n.get(l).then(function(n){var t=n.data,i;s(t)?(t&&t!=="null"&&(r.error("Improperly structured Dynamic GPS result set",t),o.createEvent(o.eventTypes.dgps.invalid).reject({results:t})),f.reject(t)):(i=c(t),f.resolve({suggestions:i}))},function(n){f.reject(n)}),f.promise)}}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).filter("icon",[function(){return function(n){return typeof n=="string"&&(n.indexOf("0x")===-1&&(n="0x"+n),n=String.fromCharCode(n)),n}}]),function(n){n.directive("instantAnswer",["$sce",function(n){var t={stepLimit:5,previewStepCount:4};return{restrict:"A",templateUrl:"/PartialViews/Search/InstantAnswer.html",scope:{answer:"=instantAnswer",view:"="},link:function(i){i.config=t;i.activeIndex=0;i.isLimited=!0;i.switchTab=function(n){i.activeIndex=n;i.isLimited=!0};i.showMore=function(){i.isLimited=!1};i.trustSrc=function(t){return n.trustAsResourceUrl(t)}}}}])}(angular.module(microsoft.support.moduleName));angular.module(microsoft.support.moduleName).directive("paginator",["$document",function(n){return{restrict:"A",require:"ngModel",templateUrl:"/PartialViews/Search/Paginator.html",scope:{maxCount:"=",view:"="},link:function(t,i,r,u){function e(n){var o,i,e,u;for(t.lastPage=!1,o=n<f+1?1:n-f,i=n+f,i>t.maxCount/r.itemsPerPage&&(i=Math.ceil(t.maxCount/r.itemsPerPage),t.lastPage=n==i),e=[],u=o;u<=i;++u)e.push(u);return e}var f=4;t.ngModel=u;t.lastPage=!1;t.selectPage=function(i){u.$setViewValue(i);t.pages=e(i);n[0]&&n[0].activeElement&&n[0].activeElement.blur()};t.$watch("maxCount",function(){t.selectPage(u.$viewValue||1)})}}}]),function(n){n.controller("SearchController",["$scope","$window","$rootScope","$route","$routeParams","$location","compassService","languageService","osService","clientConfig","chatStateService","authenticationHelperService","flightService",function(n,t,i,r,u,f,e,o,s,h,c,l,a){function v(){var t=e.getSearchView();t&&(n.view=t)}function y(){n.displayAllContent=r.current.data&&r.current.data.isLandingPage==!0}function p(){return a.isUserInFlight("virtualagent-dialog-1")&&n.displayAllContent&&!s.isMobile()}n.reset=function(){n.userQuery=f.search().query||"";n.userQuery=unescape(n.userQuery);y();n.isInVirtualAgentFlight=p();v()};n.primarySearchClicked=function(){if(n.userQuery!=""){var t=n.userQuery;i.$broadcast("SearchPrimaryClicked",{Location:"Primary",SearchString:n.userQuery});f.path("/"+o.langLocale().toLowerCase()+"/search/").search("query",t)}};n.linkClick=function(n,r){switch(r){case"contact-support":var u="https://"+f.host()+"/"+o.langLocale()+"/contact/menu/";i.$broadcast("setParentCv");t.open(u,"contactSupport","width=320,height=530,resizable=yes,scrollbars=yes",!0);n.preventDefault()}};n.$on("$routeChangeSuccess",function(){y();n.isInVirtualAgentFlight=p()});n.$on("CompassContentReady",function(){v()});n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("searchResult",[function(){return{restrict:"A",templateUrl:"/PartialViews/Search/SearchResult.html",scope:{result:"=searchResult",id:"="},link:function(n){n.selectResult=function(){n.pingbackUrl=n.result.pingbackUrl}}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("SearchResultsController",["$scope","$routeParams","$window","$location","$anchorScroll","osService","searchResultsService","compassService","clientConfig","flightService","virtualAgentService",function(n,t,i,r,u,f,e,o,s,h,c){function p(){if(n.userQuery.length){n.results=[];n.answer=null;n.isSearching=!0;var t={query:n.userQuery,page:n.currentPage};h.isUserInFlight(y)?c.fetchContent(t).then(l,a):e.fetchResults(t).then(l,a)}}function l(t){n.count=t.totalCount;n.results=t.results;n.answer=t.instantAnswer;n.isSearching=!1;f.isMobile()&&w()}function a(){n.isSearching=!1}function w(){var n=r.hash();r.hash("search-results-container");u();r.hash(n)}function v(){var t=o.getSearchResultsView();t&&(n.view=t)}var y="virtualagent-searchresults-1";n.reset=function(){n.userQuery=t.query||"";n.userQuery=unescape(n.userQuery);n.currentPage=1;n.results=[];n.answer=null;n.isSearching=!1;n.devicesEnabled=s.SearchConfig.DeviceRefinementEnabled;v()};n.generalSearch=function(){i.location.href=n.view.generalSearchLink.linkUrl.replace("{0}",encodeURIComponent(n.userQuery))};n.$watch("currentPage",function(){p()});n.$on("SearchResultsTimeout",function(){n.isSearching=!1});n.$on("CompassContentReady",function(){v()});n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("searchResultsService",["$http","$rootScope","$log","$timeout","clientConfig","languageService","osService",function(n,t){function r(n){if(n&&n.HelpContent){helpContent=n.HelpContent.replace(new RegExp(String.fromCharCode(57356),"g"),"<strong>").replace(new RegExp(String.fromCharCode(57344),"g"),"<strong>").replace(new RegExp(String.fromCharCode(57357),"g"),"<\/strong>").replace(new RegExp(String.fromCharCode(57345),"g"),"<\/strong>");return i(JSON.parse(helpContent))}return null}function i(n){var r=!1,u=0;for(var t in n)n.hasOwnProperty(t)&&(u++,angular.isObject(n[t])&&(n[t]=i(n[t])),r=t==="value");return r&&u===1?n.value:n}function u(n){var t=n.Title.replace(/\<\/?strong\>/g,"");return{simpleTitle:t,title:n.Title,description:n.Description,link:n.Link,displayLink:n.DisplayLink,pingbackUrl:n.PingbackUrl}}this.fetchResults=function(i){var f={params:{query:encodeURIComponent(i.query),page:i.page}};return n.get("/api/search/index",f).then(function(n){var f=n.data.Results.map(u),i={};return i.results=f,i.totalCount=n.data.TotalCount,i.instantAnswer=r(n.data),t.$broadcast("SearchResponse",i),i})}}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("virtualAgentDialog",["$q","$location","$timeout","$rootScope","virtualAgentService","focusContentService",function(n,t,i,r,u,f){var e={user:"USER",virtualAgent:"VIRTUAL_AGENT"};return{restrict:"A",templateUrl:"/PartialViews/Search/VirtualAgentDialog.html",scope:{view:"="},link:function(t){function c(n){r.$broadcast("VirtualAgentDialogUserResponse",{searchText:n});t.dialogQuery="";t.messages.push({sender:e.user,text:n});o(n).then(s,h)}function l(){r.$broadcast("VirtualAgentDialogEngagement",{searchText:t.initialQuery});t.isDialogActive=!0;n.all([i(function(){},500),o(t.initialQuery)]).then(function(n){s(n[1])},h);f.focus("virtual-agent-input")}function o(n){return t.isSearching=!0,t.activeQuery=n,t.searchResultsLink="/{lang-locale}/search?query="+encodeURIComponent(n),u.fetchContent({query:n,page:1})}function s(n){t.messages.push({sender:e.virtualAgent,content:n});t.isSearching=!1}function h(){t.isSearching=!1}t.isDialogActive=!1;t.messages=[];t.senderTypes=e;t.askVirtualAgent=c;t.searchResultsLink;t.startVirtualAgent=l;t.isSearching=!1}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("virtualAgentService",["$http","$q","$document","$rootScope",function(n,t,i,r){function e(n){var i,u;return!n.data.content||!n.data.content.webResults?t.reject({error:"Invalid property values"}):(i=o(n.data.content),f=n.data.sessionId,u={results:n.data.content.webResults.items.map(s),instantAnswer:i.instantAnswer,dialogResponse:i.dialogResponse,dialogQuestion:i.dialogQuestion,totalCount:n.data.content.webResults.totalEstimatedMatches},r.$broadcast("SearchResponse",u),u)}function o(n){var t={instantAnswer:null,dialogResponse:null,dialogQuestion:null},r,i;return n.answers?(answersText=JSON.stringify(n.answers).replace(new RegExp(String.fromCharCode(57356),"g"),"<strong>").replace(new RegExp(String.fromCharCode(57357),"g"),"<\/strong>"),r=JSON.parse(answersText),r&&r.length&&(t.instantAnswer=r.filter(function(n){return n.type==="InstantAnswer"})[0],t.instantAnswer=t.instantAnswer&&t.instantAnswer.content[0],i=r.filter(function(n){return n.type==="Dialog"})[0],t.dialogQuestion=i&&i.question&&i.question.text,t.dialogResponse=i&&i.content&&i.content[0]),t):t}function s(n){return{simpleTitle:n.title.replace(/\<\/?b\>/g,""),title:n.title,description:n.description,link:n.url,displayLink:n.displayUrl}}var u,f;this.fetchContent=function(i){var r={params:{query:encodeURIComponent(i.query),page:i.page,sessionId:f}};return u&&u.query===i.query&&u.page===i.page?t.when(u.result):n.get("/api/search/virtualagent",r).then(e).then(function(n){return u={result:n,query:i.query,page:i.page},n})}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("appCommandQosTelemetryService",["$rootScope","$timeout","clientConfig","qosTelemetryService","contactCommands","nativeAppService",function(n,t,i,r,u,f){function s(n){return h.some(function(t){return n===t})}function c(t){var i,r;f.isUnderstoodCommand(t)?(i="//app/command-error",r="Command: "+t+" failed"):(i="//app/unknown-command",r="Unknown command: "+t+" failed");n.$broadcast("Qos",{operation:i,status:500,custom:r})}var h=[u.beginSharing,u.pauseSharingByUser,u.resumeSharingByUser,u.endSharingByUser],e=this,o={timeout:i.AppConfig&&i.AppConfig.AppCommandTimeoutInMilliseconds};this.qosActions={};n.$on("AppActionStart",function(n,i){if(s(i)){e.qosActions[i]?e.qosActions[i].length>=1&&r.createEvent(r.eventTypes.app.dupeCommandError).reject(i):e.qosActions[i]=[];var u=r.createEvent(i);e.qosActions[i].push({promise:u,timer:t(function(){u.reject(i+" timed out after "+o.timeout+" milliseconds.")},o.timeout)})}});n.$on("AppActionEnd",function(n,i){var r=i.command,u;s(r)?e.qosActions[r]&&e.qosActions[r].length>0&&(u=e.qosActions[r].shift(),t.cancel(u.timer),i.success?u.promise.resolve():u.promise.reject(r)):c(r)})}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("callbackTelemetryService",["$rootScope","clientConfig","clientTelemetryService","nativeAppService","languageService","rccService","serverInfo","phoneNumberService","chatStateService",function(n,t,i,r,u,f,e,o,s){var h={unknown:"unknown",EnqueueImmediateCallback:"enqueueImmediateCallback",EnqueueScheduledCallback:"enqueueScheduledCallback",EnqueueCallback:"enqueueCallback"},c=function(n,t){var r={name:"Microsoft.Mac.SelfAssist.CallbackAction",content:{"Microsoft.Mac.SelfAssist.CallbackAction":{actionName:n,callbackTime:t&&t.timeslot?t.timeslot:"",errorCode:t&&t.errorCode?t.errorCode:"",immediateCallbackDelay:t&&!(t.immediateCallbackDelay==null)?t.immediateCallbackDelay:-1,subjectName:f.getSubjectName()?f.getSubjectName():"",countryCode:t.locale?o.selectCountryCode(t.locale).code:"",subjectId:s.getSubject()?s.getSubject().toString():"",visitId:s.getVisitId()?s.getVisitId():"",enqueueId:s.getEnqueueId()?s.getEnqueueId().toString():"",interactionId:t&&t.interactionId?t.interactionId:""}}};r=i.populateDefaultFields(r);i.pushEvent(r)};n.$on("EnqueueCallbackFailure",function(n,t){c(h.EnqueueCallback,t)});n.$on("EnqueueCallbackSuccess",function(n,t){var r=JSON.parse(t.methodParameters.context),i;r.timeslot?(t.timeslot=r.timeslot,c(h.EnqueueScheduledCallback,t)):(i=f.getEstimatedCallbackWaitTime(t.methodParameters.subject),i&&(t.immediateCallbackDelay=i.AverageWaitTime),c(h.EnqueueImmediateCallback,t))})}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("chatTelemetryService",["$rootScope","$window","clientConfig","serverInfo","chatStateService","clientTelemetryService","rccService",function(n,t,i,r,u,f,e){var o={unknown:"unknown",chatFeedback:"chatFeedback",chatRequested:"chatRequested",chatEnded:"chatEnded",chatMessageSent:"chatMessageSent",chatMessageRecieved:"chatMessageRecieved",chatSessionEstablished:"chatSessionEstablished",agentDataReady:"agentDataReady",chatInitComplete:"chatInitComplete",enqueueChat:"enqueueChat",dequeueChat:"dequeueChat",chatExtendedWait:"chatExtendedWait",chatQueueStatus:"chatQueueStatus",chatTransferred:"chatTransferred",chatLongQueue:"chatLongQueue",chatScreenShareAccept:"chatScreenShareAccept",chatScreenShareDenied:"chatScreenShareDenied",chatScreenShareEstablished:"chatScreenShareEstablished",chatScreenShareRequest:"chatScreenShareRequest",chatScreenShareError:"chatScreenShareError",chatScreenShareConnectFailed:"chatScreenShareConnectFailed",html5Hotification:"html5Hotification",chatSurveyDisplayed:"chatSurveyDisplayed",cvExtention:"cvExtention",awasaVisitId:"awasaVisitId",awasaEnqueueId:"awasaEnqueueId",awasaChatId:"awasaChatId",chatReset:"chatReset",doubleChatEnqueued:"doubleChatEnqueued",passcodeSuccess:"passcodeSuccess",passcodeFailure:"passcodeFailure"},s=function(n,i,r){i=i?i:"";r=r?r.toString():u.getEnqueueId()?u.getEnqueueId().toString():"";var o={name:"Microsoft.Mac.SelfAssist.ChatAction",content:{"Microsoft.Mac.SelfAssist.ChatAction":{actionName:n,agentID:u.getAgent()&&u.getAgent().AgentId?u.getAgent().AgentId.toString():"",activityID:u.getVisitId()?u.getVisitId():"",subjectName:e.getSubjectName()?e.getSubjectName():"",subjectId:u.getSubject()?u.getSubject().toString():"",visitId:u.getVisitId()?u.getVisitId():"",enqueueId:r,chatId:u.getChatId()?u.getChatId().toString():"",pageHasFocus:t.document.hasFocus(),isRatMode:e.isRatMode(),custom1:i}}};o=f.populateDefaultFields(o);f.pushEvent(o)};n.$on("ChatReset",function(){s(o.chatReset)});n.$on("DoubleChatEnqueued",function(){s(o.doubleChatEnqueued)});n.$on("ChatRequested",function(){s(o.chatRequested)});n.$on("AgentDataReady",function(){s(o.agentDataReady)});n.$on("ChatSessionEstablished",function(){s(o.chatSessionEstablished)});n.$on("ChatInitComplete",function(){s(o.chatInitComplete)});n.$on("ChatMessageReceived",function(){s(o.chatMessageRecieved)});n.$on("ChatSessionClosed",function(){s(o.chatEnded)});n.$on("ChatMessageSendSuccess",function(){s(o.chatMessageSent)});n.$on("ChatExtendedWait",function(){s(o.chatExtendedWait)});n.$on("ChatQueueStatus",function(n,t){s(o.chatQueueStatus,t.position+"")});n.$on("ChatFeedback",function(n,t){s(o.chatFeedback,JSON.stringify(t))});n.$on("EnqueueChatSuccess",function(n,t){s(o.enqueueChat,t.waitTimeEstimate+"",t.enqueueId)});n.$on("ChatScreenShareAccept",function(){s(o.chatScreenShareAccept)});n.$on("ChatScreenShareDenied",function(){s(o.chatScreenShareDenied)});n.$on("ChatScreenShareEstablished",function(){s(o.chatScreenShareEstablished)});n.$on("ChatScreenShareRequest",function(){s(o.chatScreenShareRequest)});n.$on("ChatScreenShareError",function(n,t){s(o.chatScreenShareError,t.command+"")});n.$on("ChatScreenShareConnectFailed",function(){s(o.chatScreenShareConnectFailed)});n.$on("ChatDisengageSuccess",function(){s(o.dequeueChat)});n.$on("ChatTransferred",function(){s(o.chatTransferred)});n.$on("ChatLongQueue",function(){s(o.chatLongQueue)});n.$on("setParentCv",function(){t&&t.Asimov&&t.Asimov.cv&&u.setParentCv(t.Asimov.cv.getValue())});n.$on("chatSurveyDisplayed",function(){s(o.chatSurveyDisplayed)});n.$on("Html5Notification",function(n,t){s(o.html5Hotification,t)});n.$on("cvExtention",function(n,t){s(o.cvExtention,t)});n.$on("awasaVisitId",function(n,t){s(o.awasaVisitId,t.toString())});n.$on("awasaEnqueueId",function(n,t){s(o.awasaEnqueueId,t.toString())});n.$on("awasaChatId",function(n,t){s(o.awasaChatId,t.toString())});n.$on("PasscodeSuccess",function(){s(o.passcodeSuccess)});n.$on("PasscodeFailure",function(n,t){s(o.passcodeFailure,t)})}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("clientTelemetryService",["clientConfig","$window","$location","$interval","$cookies","nativeAppService","languageService","chatStateService",function(n,t,i,r,u,f,e,o){var s;t&&t.Asimov&&(t.Asimov.appId="JS:"+i.host());this.pushEvent=function(n){t.Asimov.writeEvent(n)};this.populateDefaultFields=function(i){i.content[i.name].userAgent=t.navigator.userAgent;i.content[i.name].server=n.UserPropertyConfig&&n.UserPropertyConfig.EnvironmentType!==undefined?n.UserPropertyConfig.EnvironmentType:"";i.content[i.name].muid=u.MUID;i.content[i.name].puid=n.authInfo&&n.authInfo.puid!==undefined?n.authInfo.puid:"0";i.content[i.name].language=e.lang()?e.lang():"";i.content[i.name].locale=e.locale()?e.locale():"";i.content[i.name].isNative=f.isNative()?!0:!1;i.content[i.name].partnerId=u.smcpartner;i.content[i.name].flightId=u.smc_f;i.content[i.name].parentCv=o.getParentCv()?o.getParentCv().toString():"";var r=u.ANON;return r!=null&&r.length>2&&(i.content[i.name].anid=r.substring(2,r.indexOf("&"))),i};n&&n.ClientLogConfig&&n.ClientLogConfig.ScriptErrorLogging&&(t.onerror=function(n,t,i,r,u){var f;return f=u?u.stack:(new Error).stack,!0});s=u["MS-CV"];s!==null&&t&&t.Asimov&&t.Asimov.CorrelationVector&&t.Asimov.CorrelationVector.isValid(s)&&t.Asimov.cv.setValue(s);t&&t.location&&t.location.host&&t.location.host.indexOf("partner")<0&&(u.smcpartner=f.isNative()?"csapp":"smc"),function(){if(t&&t.Asimov){var n=t.Asimov._validateAndTranslateEvent;t.Asimov._validateAndTranslateEvent=function(i){var r;return r=n.call(t.Asimov,i),t.Asimov.appId!=null&&(r.event.appId=self.Asimov.appId),r}}}()}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("correlationVectorService",["$window","$rootScope",function(n,t){this.extendCv=function(){if(n&&n.Asimov&&n.Asimov.cv){var i=n.Asimov.cv.getValue()+".0";n.Asimov.cv.setValue(i);t.$broadcast("cvExtention",n.Asimov.cv.getValue())}}}])}(angular.module(microsoft.support.moduleName)),function(n){var t=function(n,t,i,r,u){var f={name:"Microsoft.Mac.SelfAssist.KbArticleAction",content:{"Microsoft.Mac.SelfAssist.KbArticleAction":{actionName:t,title:i,locale:r,articleId:u}}};return n.populateDefaultFields(f)},i={machineTranslatedArticleLoaded:"machineTranslatedArticleTranslated",machineTranslationFailed:"machineTranslationFailed"};n.service("kbTelemetryService",["clientTelemetryService",function(n){this.logMtArticleTranslated=function(r,u,f){var e="translation of articleId "+r+" succeeded in "+f+"ms",o=t(n,i.machineTranslatedArticleLoaded,e,u,r);n.pushEvent(o)};this.logMtArticleTranslationFailed=function(r,u,f){angular.isString(u)&&u.length!=0||(u="unspecified");var e="translation of articleId "+r+" failed for reason "+u,o=t(n,i.machineTranslationFailed,e,f,r);n.pushEvent(o)}}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("menuTelemetryService",["$window","$rootScope","$location","clientConfig","clientTelemetryService","nativeAppService","languageService","serverInfo",function(n,t,i,r,u){var f={unknown:"unknown",menuLinkClicked:"menuLinkClicked",menuExtraClicked:"menuExtraClicked"},e={nativeAppClosing:"nativeAppClosing",notifyAppClosingComplete:"notifyAppClosingComplete"},o=function(n,t){var i={name:"Microsoft.Mac.SelfAssist.SupportMenuAction",content:{"Microsoft.Mac.SelfAssist.SupportMenuAction":{actionName:n,link:t&&t.link&&t.link.linkUrl?t.link.linkUrl:""}}};i=u.populateDefaultFields(i);u.pushEvent(i)},c=function(n){var t={name:"Microsoft.Mac.SelfAssist.SiteFeedback",content:{"Microsoft.Mac.SelfAssist.SiteFeedback":{actionName:"SiteFeedback",type:n&&n.type?n.type:"",comment:n&&n.comment?n.comment:""}}};t=u.populateDefaultFields(t);u.pushEvent(t)},s=function(){var n={name:"Microsoft.Mac.SelfAssist.PageAction",content:{"Microsoft.Mac.SelfAssist.PageAction":{actionName:"PageUnload",custom1:i.absUrl()}}};n=u.populateDefaultFields(n);u.pushEvent(n)},h=function(n){var t={name:"Microsoft.Mac.SelfAssist.SupportAppAction",content:{"Microsoft.Mac.SelfAssist.SupportAppAction":{actionName:n}}};t=u.populateDefaultFields(t);u.pushEvent(t)};t.$on("MenuLinkClicked",function(n,t){o(f.menuLinkClicked,t)});t.$on("MenuExtraClicked",function(n,t){o(f.menuExtraClicked,t)});t.$on("SiteFeedback",function(n,t){c(t)});t.$on("NativeAppClosing",function(){h(e.nativeAppClosing)});t.$on("NotifyAppClosingComplete",function(){h(e.notifyAppClosingComplete)});$(n).bind("unload",s);$(n).bind("onunload",s)}])}(angular.module(microsoft.support.moduleName)),function(n){n.factory("qosTelemetryInterceptor",["$q","$rootScope","$log",function(n,t,i){function u(n){var i={};i.latency=(new Date).getTime()-n.config.startTime;i.status=n.status;i.operation=n.config.url;t.$broadcast("QoS",i)}function f(n){var i={};i.operation="//app/invalid-request";i.status=500;i.latency=0;i.custom=JSON.stringify(n);t.$broadcast("QoS",i)}var r={};return r.request=function(n){return n.startTime=(new Date).getTime(),n},r.response=function(n){return n.config&&!n.config.url.match(/html$/)&&u(n),n},r.responseError=function(t){return t.config&&!t.config.url.match(/html$/)?u(t):t.config||f(t),i.error("Error occurred during http request",JSON.stringify(t)),n.reject(t)},r}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("qosTelemetryService",["$rootScope","$q","$window","$location","clientTelemetryService","chatStateService",function(n,t,i,r,u,f){function c(n){var t=n.operation.replace(/[?].*/,"");return t.match(/^\/api/)?t=t.split("/").splice(0,4).join("/"):t.match(/^https:\/\/dgps/)&&(t=o.dgps.suggest),t===o.awasa.error&&n.custom&&n.custom.errorCode&&(t=t+"/"+n.custom.errorCode.toLowerCase()),t}function l(n){return n.latency="latency"in n?n.latency:-1,n.operation="operation"in n?n.operation:"",n.status="status"in n?n.status+"":"",n.error="error"in n?n.error:-1,n.custom="custom"in n?n.custom:"",n}function s(n,t){var n;t=l(t);var i=c(t),s=i,o=e[i]?e[i].description:"";angular.isObject(t.custom)&&(t.custom=JSON.stringify(t.custom));n={name:"Ms.Webi.OutgoingRequest",content:{"Ms.Qos.OutgoingServiceRequest":{operationName:i,dependencyName:"SelfAssistWeb",dependencyType:"WebService",dependencyOperationName:"",latencyMs:t.latency,targetUri:t.operation,succeeded:t.status>=200&&t.status<400,serviceErrorCode:t.error,protocolStatusCode:t.status},"Ms.Webi.OutgoingRequest":{description:o,route:r.url(),visitId:f.getVisitId(),custom1:t.custom}}};n=u.populateDefaultFields(n);u.pushEvent(n)}var h=this,o={app:{exception:"//app/exception",error:"//app/error",unknownRoute:"//app/unknown-route",unknownCommand:"//app/unknown-command",commandError:"//app/command-error",dupeCommandError:"//app/dupe-command-error",invalidRequest:"//app/invalid-request",beginsharing:"//app/begin-sharing",pausesharingbyuser:"//app/pause-sharing-by-user",resumesharingbyuser:"//app/resume-sharing-by-user",endsharingbyuser:"//app/end-sharing-by-user"},awasa:{error:"//awasa/error",callback:"//awasa/callback",chat:"//awasa/chat",times:"//awasa/times",sendMessage:"//awasa/message",disengage:"//awasa/disengage",download:"//awasa/download",initialize:"//awasa/initialize",channelDisconnect:"//awasa/channel-disconnect",channelReconnect:"//awasa/channel-reconnect",agentDisconnect:"//awasa/agent-disconnect",agentReconnect:"//awasa/agent-reconnect",sendCommand:"//awasa/send-command",channelStatus:"//awasa/channel-status",chatReconnectTimedOut:"//awasa/chat-reconnect-timeout"},dgps:{suggest:"//dgps/suggestions",unknownLocale:"//dgps/unknownlocale",invalid:"//dgps/invalid"},"native":{appStartContext:"//app/appStartContext"}},e;this.eventTypes=o;e={};e["/api/content/GetAgent"]={description:"Event triggered when agent information is requested from Awasa."};e["/api/contentGetCompassContentForPage"]={description:"Event triggered when resources such as strings and images are requested from Compass."};e["/api/Devices/Index"]={description:"Event triggered when device information associated with the user is requested from DDS."};e["/api/kb/GetKbArticle"]={description:"Event triggered when a KB article is requested."};e["/api/search/index"]={description:"Event triggered to provide search results for a given search term"};e["/api/Token/GetToken"]={description:"Event triggered when a security token to allow the user to use the chat and callback functionality is requested from the Awasa Security service."};e["/api/Token/GetUserState"]={description:"Event triggered when encryption of user information is requested from Awasa."};e["/api/v1/AutoSuggestion"]={description:"Event triggered when autosuggestions are requested from DGPS. This request goes directly to the DGPS endpoint."};e["/app/ScheduleCallbackTimesTimeout"]={description:"Event triggered when a timeout occurs while waiting for the times available to schedule a call."};e[o.app.error]={description:"Event triggered when an error occurs in the code running on the client side."};e[o.app.exception]={description:"Event triggered when exception is caught by the AngularJS exception handler."};e[o.app.unknownRoute]={description:"Event triggered when the user attempts to go to a route not rendered by support.microsoft.com"};e[o.app.unknownCommand]={description:"Event triggered when the a command received from the native app is not understood or is unknown to web"};e[o.app.commandError]={description:"Event triggered when a command received from the native app has failed"};e[o.app.dupeCommandError]={description:"Event triggered when a duplicate command is sent to the app for processing, only one of a type should fire at a time."};e[o.app.beginsharing]={description:"Event triggered when beginsharing command is sent from web to app"};e[o.app.pausesharingbyuser]={description:"Event triggered when pausesharingbyuser command is sent from web to app"};e[o.app.resumesharingbyuser]={description:"Event triggered when resumesharingbyuser command is sent from web to app"};e[o.app.endsharingbyuser]={description:"Event triggered when endsharingbyuser command is sent from web to app"};e[o.awasa.callback]={description:"Event triggered when a callback (either schedule or immediate) is requested from Awasa. This request goes directly to the Awasa endpoint."};e[o.awasa.chat]={description:"Event triggered when a chat is queued. This request goes directly to the Awasa endpoint."};e[o.awasa.disengage]={description:"Event triggered when a chat is ended or a user leaves the queue. This request goes directly to the Awasa endpoint."};e[o.awasa.error]={description:"Event triggered when an error occurs in the client-side Awasa framework."};e[o.awasa.sendMessage]={description:"Event triggered when a message is sent or received from the chat experience. This request goes directly to the Awasa endpoint."};e[o.awasa.times]={description:"Event triggered when a user request to see the open time slots to schedule a call. This request goes directly to the Awasa endpoint."};e[o.awasa.download]={description:"Event triggered when the Awasa SDK is downloaded to the client"};e[o.awasa.initialize]={description:"Event triggered when the 'loaded' callback is called from the Awasa SDK. Indicates that the Awasa SDK has successfully been initialized."};e[o.awasa.channelReconnect]={description:"Event triggered from the Awasa SDK when the user reconnects to the chat after being disconnected"};e[o.awasa.channelDisconnect]={description:"Event triggered from the Awasa SDK when a connection issue occurs on the user side of a chat"};e[o.awasa.agentDisconnect]={description:"Event triggered from the Awasa SDK when a connection issue occurs on the agent side of a chat"};e[o.awasa.agentReconnect]={description:"Event triggrered from the Awasa SDK when the agent reconnects to the chat after being disconnected"};e[o.awasa.sendCommand]={description:"Event triggered when a command is sent to the agent via the Awasa SDK."};e[o.awasa.channelStatus]={description:"Event triggered when chat and callback status is requested from the Awasa SDK."};e[o.awasa.chatReconnectTimedOut]={description:"Event triggered when attempting to reconnect chat times out."};e[o.native.appStartContext]={description:"Event triggered when the app starts and sends back context on how the app was launched."};e["//awasa/callback/channel_error"]={description:"Event triggered when there is an issue with the Awasa callback channel."};e["//awasa/callback/channel_contactinvalid"]={description:"Event triggered when the contact number is rejected as invalid by the telephony service"};e["//awasa/callback/request_unauthorized"]={description:"Event triggered when a callback API call is made with an invalid token"};this.createEvent=function(n){var i={operation:n},r=(new Date).getTime(),u=t.defer();return u.promise.then(function(n){i.latency=(new Date).getTime()-r;i.status=200;i.custom=n||"";s({},i)},function(n){i.latency=(new Date).getTime()-r;i.status=n&&n.status||500;i.custom=n||"";s({},i)}),u};n.$on("QoS",s);n.$on("AutoSuggestBadResults",function(){h.createEvent(o.dgps.invalid).reject()});n.$on("500Error",function(n,t){t&&s(n,{operation:o.app.error,status:"500",custom:t})});n.$on("404Error",function(n,t){t&&s(n,{operation:o.app.unknownRoute,status:"404",custom:t})});n.$on("AppStartContext",function(n,t){s(n,{operation:o.native.appStartContext,status:"200",custom:t})})}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("searchTelemetryService",["$rootScope","$window","clientConfig","serverInfo","chatStateService","clientTelemetryService",function(n,t,i,r,u,f){var e={unknown:"unknown",searchPrimaryClicked:"searchPrimaryClicked",instantAnswerFound:"instantAnswerFound",dialogQuestionFound:"dialogResponseQuestionFound",dialogResponseFound:"dialogResponseContentFound",virtualAgentDialogUserResponse:"virtualAgentDialogUserResponse",virtualAgentDialogEngagement:"virtualAgentDialogEngagement"},o=function(n,t,i){t=t||"";i=i||"";var r={name:"Microsoft.Mac.SelfAssist.SearchAction",content:{"Microsoft.Mac.SelfAssist.SearchAction":{actionName:n,custom1:t,custom2:i}}};r=f.populateDefaultFields(r);f.pushEvent(r)};n.$on("SearchPrimaryClicked",function(n,t){o(e.searchPrimaryClicked,t.Location,t.SearchString)});n.$on("SearchResponse",function(n,t){t&&(t.instantAnswer&&o(e.instantAnswerFound),t.dialogQuestion&&o(e.dialogQuestionFound),t.dialogResponse&&o(e.dialogResponseFound))});n.$on("VirtualAgentDialogUserResponse",function(n,t){o(e.virtualAgentDialogUserResponse,t.searchText)});n.$on("VirtualAgentDialogEngagement",function(n,t){o(e.virtualAgentDialogEngagement,t.searchText)})}])}(angular.module(microsoft.support.moduleName)),function(n){n.run(["chatTelemetryService","searchTelemetryService","callbackTelemetryService","menuTelemetryService","qosTelemetryService","wedcsService","authenticationHelperService","seoService","appCommandQosTelemetryService",function(){}]);n.config(["$httpProvider",function(n){n.interceptors.push("qosTelemetryInterceptor");n.interceptors.push("errorInterceptor")}])}(angular.module(microsoft.support.moduleName)),function(n){n.service("wedcsService",["$rootScope","$window","$location","$route","rccService",function(n,t,i,r,u){function o(n){return n.type=="checkbox"?n.checked+"_"+n.value:n.nodeName=="A"?n.href:n.value}function s(n){var t="";return n.id&&(t="elemId_"+n.id),n.name&&(t=t+"_elemName_"+n.name),n.parentNode.id&&(t=t+"_parId_"+n.parentNode.id),n.parentNode.name&&(t=t+"_parName_"+n.parentNode.name),n.parentNode.parentNode.id&&(t=t+"_parParId_"+n.parentNode.parentNode.id),n.parentNode.parentNode.name&&(t=t+"_parParName_"+n.parentNode.parentNode.name),n.parentNode.parentNode.parentNode.id&&(t=t+"_parParParId_"+n.parentNode.parentNode.parentNode.id),n.parentNode.parentNode.parentNode.name&&(t=t+"_parParParName_"+n.parentNode.parentNode.parentNode.name),n.className&&(t=t+"_elemClass_"+n.className),n.type&&(t=t+"_elemType_"+n.type),t}function f(n){n.id!=u.getChatTypingBoxId()&&t&&t.MscomCustomEvent&&t.MscomCustomEvent("ms.scn",s(n),"ms.scvalue",o(n),"ms.scnct","userAction")}var e=!1;this.logWEDCS=f;$(document).ready(function(){$(document).on("click","input[type='radio'], input[type='checkbox'], button, a:not(a[id]), li",function(){f(this)});$(document).on("change","textarea",function(){f(this)})});n.$on("ButtonClickedAndDisabled",function(n,t){f(t.target)});n.$on("ChatMessageReceived",function(){t&&t.MscomCustomEvent&&t.MscomCustomEvent("ms.scn","agent-chat-post","ms.scnct","chatAction")});n.$on("ChatMessageSendSuccess",function(){t&&t.MscomCustomEvent&&t.MscomCustomEvent("ms.scn","customer-chat-post","ms.scnct","chatAction")});n.$on("metaTagsUpdated",function(){t&&t.MscomCustomEvent&&t.MscomCustomEvent("ms.scnct","viewLoad")});n.$on("SearchPrimaryClicked",function(n,r){t&&t.MscomCustomEvent&&t.MscomCustomEvent("ms.scn","search","ms.scnum",i.absUrl(),"ms.searchquery",r.SearchString)});n.$on("SearchResponse",function(n,i){i&&(i.instantAnswer&&t.MscomCustomEvent("ms.scn","instant-answer-found","ms.scnct","searchAction"),i.dialogQuestion&&t.MscomCustomEvent("ms.scn","dialog-response-question-found","ms.scnct","searchAction"),i.dialogResponse&&t.MscomCustomEvent("ms.scn","dialog-response-content-found","ms.scnct","searchAction"))});n.$on("VirtualAgentDialogUserResponse",function(){t.MscomCustomEvent("ms.scn","virtual-agent-dialog-response","ms.scnct","searchAction")});n.$on("VirtualAgentDialogEngagement",function(){t.MscomCustomEvent("ms.scn","virtual-agent-dialog-engagement","ms.scnct","searchAction")});n.$on("$routeChangeSuccess",function(){r.current.controller!=="SupportMenuController"||e||(t&&t.MscomCustomEvent&&t.MscomCustomEvent("ms.scnct","CAD-Displayed"),e=!0)})}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("compileHtml",["$compile","$parse",function(n){return{restrict:"A",link:function(t,i,r){var u=!1;r.content==null||u||(u=!0,t.$watch(function(n){return n[r.content]},function(){t.kbArticle!=null&&(i.html(t.kbArticle),n(i.contents())(t))},!0))}}}])}(angular.module(microsoft.support.moduleName));app.directive("contentSurvey",["$rootScope","compassService",function(n,t){return{restrict:"A",templateUrl:"/PartialViews/Kb/survey.html",scope:{},link:function(i){var r=function(){var n=t.getContentSurvey();n&&(i.contentSurvey=n)};i.$on("CompassContentReady",function(){r()});r();i.showSurvey=!0;i.choiceCaptionClass="choice-caption";i.OnSubmit=function(){i.type!=null?(n.$broadcast("KbSurvey",{type:i.type,suggestion:i.suggestion}),i.showSurvey=!1):i.choiceCaptionClass+=" alert alert-error"}}}}]),function(n){n.directive("fixIt",["$window",function(n){return{restrict:"A",templateUrl:"/PartialViews/Kb/fixIt.html",scope:{},link:function(t,i,r){t.link=r.link;t.caption=r.caption;t.text=r.text;t.nav=function(t){n.location.href=t}}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("guidedWalkThrough",["languageService",function(n){return{restrict:"A",templateUrl:"/PartialViews/kb/guidedWalkThrough.html",scope:{},link:function(t,i,r){var u=n.lang();t.gwt={link:"//support2.microsoft.com/common/survey.aspx?scid=sw;"+u+";"+r.gwtid+"&showpage=1",linkcaption:r.linkcaption,description:r.description}}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("hdabs",[function(){return{restrict:"A",templateUrl:"/PartialViews/kb/hdabs.html",scope:{},transclude:!0,link:function(n,t,i){n.hdabs={graphicSrc:i.graphicSrc,graphicAlt:i.graphicAlt}}}}])}(angular.module(microsoft.support.moduleName));app.directive("kbBanner",[function(){return{restrict:"A",templateUrl:"/PartialViews/Kb/banner.html",scope:{},link:function(n,t,i){n.title=i.title;n.description=i.description;n.imageUrl=i.imageUrl;n.linkText=i.linkText;n.linkUrl=i.linkUrl}}}]);app.directive("kbBingCtfWidget",["$document","$location","$log","kbTelemetryService",function(n,t,i,r){var u=null,e=function(){u.mtLoading=!0;$(".kb-article").hide()},f=function(){u.mtLoading=!1;$(".kb-article").show()},o=function(){var r="",n=t.path(),i;return n.charAt(n.length-1)=="/"&&(n=n.substr(0,n.length-1)),i=n.match(/[0-9]*$/),i&&(r=i[0]),r},s=function(n,t){var s,h,c;$("#bing-translate").length===0&&angular.isString(n)&&n.length>0&&angular.isString(t)&&t.length>0&&(s=o(),e(),h="https://ssl.microsofttranslator.com/ajax/v2/widget.aspx?siteData="+encodeURIComponent(t)+"&mode=manual&from=en&layout=ts&to="+n+"&originalDocument=/api/content/kbctf/"+s+"&category=e9b9dd63-c277-4572-9d08-fd459d9b844d_tech",c=Date.now(),$.getScript(h).done(function(){i.info("translator script element was loaded.");var t=Date.now();r.logMtArticleTranslated(s,n,t-c);u.$apply(f)}).fail(function(t,i,e){r.logMtArticleTranslationFailed(s,e,n);u.$apply(f)}))};return{restrict:"A",link:function(n,t,i){u=n;s(i.requestedlang,i.widgetsitedata)}}}]),function(n){n.controller("KbController",["$scope","$log","$window","$routeParams","$sce","$rootScope","$location","contentApiService",function(n,t,i,r,u,f,e,o){n.reset=function(){if(r.articleId!=null){var t=o.getKbArticle(r.articleId,e.search());t.then(function(t){n.kbArticle=t.kbArticle;t.noIndex&&f.$broadcast("NoIndex")})}};n.reset()}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("detectOperatingSystem",["osService",function(n){return{restrict:"A",templateUrl:"/PartialViews/Kb/DetectOS.html",scope:{},link:function(t,i,r){t.os32bitCaption=r.os32bitCaption;t.os64bitCaption=r.os64bitCaption;t.osOtherCaption=r.osOtherCaption;t.currentOS=n.isWindows()?n.is64bitWindows()?t.os64bitCaption:t.os32bitCaption:t.osOtherCaption}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("kbMetaTag",["$rootScope",function(n){return{restrict:"A",link:function(t,i,r){n.$broadcast("UpdateMetaTag",{name:r.name,value:r.value});t.$on("$destroy",function(){n.$broadcast("RemoveMetaTag",{name:r.name})})}}}])}(angular.module(microsoft.support.moduleName));app.directive("kbMsnSurvey",["$rootScope","$timeout","$window",function(){return{restrict:"A",templateUrl:"/PartialViews/Kb/msnsurvey.html",scope:{},link:function(n,t,i){n.caption=i.caption;n.yesCaption=i.yesCap;n.noCaption=i.noCap;n.yesTarget=i.yesTarget}}}]);app.directive("kbMachineTranslated",[function(){return{restrict:"A",template:"<h4 class='kb-machine-translation-notice'>{{notice}}<\/h4>",scope:{},link:function(n,t,i){n.notice=i.caption}}}]),function(n){n.directive("mats",["$compile","$parse","$sce",function(n,t,i){return{restrict:"A",templateUrl:"/PartialViews/Kb/mats.html",scope:{},link:function(n,t,r){n.mats={htmlCurr:i.trustAsHtml(r.matsHtml),learnMore:r.learnMore,learnMoreCaption:r.learnMoreCaption,runNow:r.runNow,runNowCaption:r.runNowCaption}}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.controller("MsnSurveyController",["$scope","$rootScope","$window",function(n,t,i){n.positiveSurvey=function(){i.location.href=n.yesTarget;t.$broadcast("KbMsnSurvey",{response:"yes"})};n.negativeSurvey=function(){t.$broadcast("KbMsnSurvey",{response:"no"})}}])}(angular.module(microsoft.support.moduleName));app.directive("productPicker",[function(){return{restrict:"A",templateUrl:"/PartialViews/Kb/productPicker.html",scope:{},link:function(n,t,i){n.products=n.$eval(i.products);n.products.unshift({BookMark:"all",ProductName:i.allProductsLabel});n.selectedProduct=n.products[0];n.$watch("selectedProduct",function(){n.scrollTo(n.selectedProduct.BookMark)});n.scrollTo=function(n){if(angular.isString(n))if(n=="all")$(".what-to-try").show();else{$(".what-to-try").hide();var t="."+n;$(t).show()}}}}}]),function(n){n.directive("kbProperties",["$filter",function(n){return{restrict:"A",templateUrl:"/PartialViews/Kb/kbProperties.html",scope:{},link:function(t,i,r){t.sectionHeader=r.sectionHeader;t.detailsCaption=r.detailsCaption;t.appliesToCaption=r.appliesToCaption;t.keywordsCaption=r.keywordsCaption;t.articleId=r.articleId;t.lastModified=n("date")(r.lastModified);t.revision=r.revision;t.appliesTo=JSON.parse(r.appliesTo);t.keywords=JSON.parse(r.keywords)}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("thirdParty",["$compile","$parse","languageService",function(n,t,i){return{restrict:"A",templateUrl:"/PartialViews/Kb/thirdParty.html",scope:{},link:function(n,t,r){n.thirdParty={tooltip:r.tooltip,tplink:r.tplink,tpcaption:r.tpcaption,thirdPartyImage:"http://support.microsoft.com/library/images/support/"+i.langLocale()+"/thirdparty.png"}}}}])}(angular.module(microsoft.support.moduleName)),function(n){n.directive("kbTitle",["$rootScope","$location",function(n,t){return{restrict:"A",templateUrl:"/PartialViews/Kb/kbTitle.html",scope:{},link:function(i,r,u){i.title=u.title;n.$broadcast("UpdateTitle",u.title);i.url=t.absUrl();i.emailHref="mailto:?subject="+u.emailTitle+"&body="+u.emailBody;i.emailCaption=u.emailCaption;i.printCaption=u.printCaption}}}])}(angular.module(microsoft.support.moduleName))